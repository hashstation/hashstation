import{f as v}from"./numberFormat.773889d3.js";import{t as n}from"./hs_tile.1abbd2f6.js";import{n as l}from"./index.70a8f19e.js";import{F as u}from"./fileUploader.98fe6c14.js";import"./vendor.6aa46313.js";var m=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("fc-tile",{staticClass:"mx-auto dictContentContainer",attrs:{title:e.data?"Import from "+e.data.path||"Server browser":"Connecting...",icon:"mdi-server-network"}},[e.data!==null?t("v-list",{staticClass:"filesCont",attrs:{tile:"",nav:""}},[t("v-list-item",{directives:[{name:"show",rawName:"v-show",value:e.data.parent!=="",expression:"data.parent !== ''"}],on:{click:function(i){return e.loadDirectory(e.data.parent)}}},[t("v-list-item-action",[t("v-icon",[e._v("keyboard_backspace")])],1),t("v-list-item-content",[t("v-list-item-title",[e._v("..")]),t("v-list-item-subtitle",[e._v(e._s(e.data.parent))])],1)],1),t("v-list-item",{directives:[{name:"show",rawName:"v-show",value:e.data.folders.length==0&&e.data.files.length==0,expression:"data.folders.length == 0 && data.files.length == 0"}]},[t("v-list-item-action",[t("v-icon",[e._v("mdi-folder-alert")])],1),t("v-list-item-content",[t("v-list-item-title",[e._v("Empty folder")]),t("v-list-item-subtitle",[e._v("Go up or add files on server")])],1)],1),e._l(e.data.folders,function(i){return t("v-list-item",{key:i.name,on:{click:function(a){return e.loadDirectory(i.path)}}},[t("v-list-item-action",[t("v-icon",[e._v("folder")])],1),t("v-list-item-content",[t("v-list-item-title",[e._v(e._s(i.name))]),t("v-list-item-subtitle",[e._v(e._s(i.path))])],1)],1)}),e._l(e.data.files,function(i){return t("v-list-item",{key:i.name,class:{selected:e.selectedFiles[i.path]!==void 0&&e.selectedFiles[i.path]!==null},on:{click:function(a){return e.fileSelected(i.name,i.path)}}},[t("v-list-item-action",[t("v-icon",{staticClass:"whiteAfterSelected"},[e._v(" insert_drive_file ")])],1),t("v-list-item-content",[t("v-list-item-title",{staticClass:"whiteAfterSelected"},[e._v(" "+e._s(i.name)+" ")]),t("v-list-item-subtitle",{staticClass:"whiteAfterSelected"},[e._v(" "+e._s(i.path)+" ")])],1)],1)})],2):e._e(),Object.keys(e.selectedFiles).length>0?t("div",[t("v-divider"),t("v-card-title",[e._v("Selected files:")]),e._l(e.selectedFiles,function(i){return t("v-card-text",{key:i.name,staticClass:"my-0 py-0"},[e._v(" "+e._s(i.path)+" ")])}),t("v-btn",{staticClass:"selectBtn d-block mx-auto",attrs:{color:"primary"},on:{click:e.upload}},[e._v(" Add ")]),t("v-divider"),t("v-progress-linear",{attrs:{query:!0,active:e.adding,color:"primary"},model:{value:e.progress,callback:function(i){e.progress=i},expression:"progress"}}),e.adding?t("v-card-text",{staticClass:"my-0 py-0"},[e._v(" It may take a few minutes to complete this action. Please check back later. ")]):e._e()],2):e._e()],1)},p=[];const f={name:"ServerBrowser",components:{"fc-tile":n},props:{sort:Boolean,hex_wordlist:Boolean},data:function(){return{data:null,selectedFiles:{},adding:!1,progress:0}},mounted:function(){this.loadDirectory("/usr/share/assets/dictionaries/")},methods:{uploadChange(e){this.progress=Math.round(e.loaded*100/e.total)},loadDirectory:function(e){this.axios.get(this.$serverAddr+"/directory",{params:{path:e}}).then(s=>{this.data=s.data})},fileSelected:function(e,s){this.selectedFiles[s]===void 0||this.selectedFiles[s]===null?this.$set(this.selectedFiles,s,{name:e,path:s}):this.$delete(this.selectedFiles,s)},upload:function(){this.progress=0,this.adding=!0;var e=Object.keys(this.selectedFiles).map(function(t){return{name:this.selectedFiles[t].name,path:this.selectedFiles[t].path}}.bind(this)),s={onUploadProgress:this.uploadChange};this.axios.post(this.$serverAddr+"/dictionary/fromFile",{files:e,sort:this.sort,hex_wordlist:this.hex_wordlist},s).then(t=>{this.adding=!1,this.$emit("filesuploaded",!0)}).catch(t=>{this.adding=!1,this.$emit("filesuploaded",!1)})}}},d={};var _=l(f,m,p,!1,h,"1441ee6b",null,null);function h(e){for(let s in d)this[s]=d[s]}var y=function(){return _.exports}(),g=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("v-container",[t("fc-tile",{staticClass:"ma-2",attrs:{title:"Dictionaries",icon:e.$route.meta.icon}},[t("v-alert",{staticClass:"mb-0",attrs:{tile:"",text:"",type:"warning"}},[e._v(" Dictionaries must have a .txt extension. ")]),t("v-data-table",{attrs:{headers:e.headers,items:e.dictionaries.items,loading:e.loading,"footer-props":{itemsPerPageOptions:[10,25,50],itemsPerPageText:"Dictionaries per page"}},scopedSlots:e._u([{key:"item.name",fn:function(i){var a=i.item;return[t("router-link",{attrs:{to:"dictionaries/"+a.id}},[e._v(" "+e._s(a.name)+" ")])]}},{key:"item.time",fn:function(i){var a=i.item;return[e._v(" "+e._s(e.$moment.utc(a.time).local().format("DD.MM.YYYY HH:mm"))+" ")]}},{key:"item.keyspace",fn:function(i){var a=i.item;return[e._v(" "+e._s(e.fmt(a.keyspace))+" ")]}},{key:"item.actions",fn:function(i){var a=i.item;return[t("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(r){var o=r.on;return[t("a",e._g({attrs:{href:e.$serverAddr+"/dictionary/"+a.id+"/download",target:"_blank",download:""}},o),[t("v-btn",{attrs:{icon:""}},[t("v-icon",[e._v("mdi-file-download-outline")])],1)],1)]}}],null,!0)},[t("span",[e._v("Download")])]),t("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(r){var o=r.on;return[t("v-btn",e._g({staticClass:"mx-0",attrs:{icon:""},on:{click:function($){return e.deleteDictionary(a)}}},o),[t("v-icon",{attrs:{color:"error"}},[e._v(" mdi-delete-outline ")])],1)]}}],null,!0)},[t("span",[e._v("Delete dictionary")])])]}}])}),e.$userCan("UPLOAD_DICTIONARIES")?t("v-card-actions",[t("v-checkbox",{attrs:{label:"Sort on upload",hint:"Sort by password length","persistent-hint":""},model:{value:e.sortUploaded,callback:function(i){e.sortUploaded=i},expression:"sortUploaded"}}),t("v-spacer"),t("v-checkbox",{attrs:{label:"HEX dictionary",hint:"Words in the dictionary to be uploaded are given in hex","persistent-hint":""},model:{value:e.hexDict,callback:function(i){e.hexDict=i},expression:"hexDict"}}),t("v-spacer"),t("v-btn",{attrs:{color:"primary",outlined:""},nativeOn:{click:function(i){i.stopPropagation(),e.browser=!0}}},[e._v(" Add from server ")]),t("v-btn",{attrs:{color:"primary",outlined:""},nativeOn:{click:function(i){i.stopPropagation(),e.uploader=!0}}},[e._v(" Upload new ")])],1):e._e()],1),t("v-dialog",{attrs:{"max-width":"500"},model:{value:e.browser,callback:function(i){e.browser=i},expression:"browser"}},[t("server-browser",{attrs:{sort:e.sortUploaded,hex_dict:e.hexDict},on:{filesuploaded:function(i){e.browser=!1,e.loadDictionaries()}}})],1),t("v-dialog",{attrs:{"max-width":"500"},model:{value:e.uploader,callback:function(i){e.uploader=i},expression:"uploader"}},[t("v-card",[t("v-card-title",[e._v(" Upload a dictionary file ")]),t("v-card-text",[t("file-uploader",{attrs:{url:this.$serverAddr+"/dictionary/add",args:{sort:e.sortUploaded,hex_dict:e.hexDict}},on:{uploadComplete:function(i){e.uploader=!1,e.loadDictionaries()}}})],1)],1)],1)],1)},x=[];const b={name:"DictionariesView",components:{FileUploader:u,"fc-tile":n,"server-browser":y},data:function(){return{loading:!1,headers:[{text:"Name",align:"start",value:"name"},{text:"Keyspace",value:"keyspace",align:"end"},{text:"Time",value:"time",align:"end"},{text:"Actions",value:"actions",align:"end",sortable:!1}],dictionaries:[],browser:!1,uploader:!1,sortUploaded:!1}},mounted:function(){this.loadDictionaries()},methods:{fmt:v,loadDictionaries:function(){this.loading=!0,this.axios.get(this.$serverAddr+"/dictionary",{}).then(e=>{this.dictionaries=e.data,this.loading=!1})},deleteDictionary:function(e){this.$root.$confirm("Delete",`This will remove ${e.name} from your dictionaries. Are you sure?`).then(s=>{this.loading=!0,this.axios.delete(this.$serverAddr+"/dictionary/"+e.id).then(t=>{this.loadDictionaries()})})}}},c={};var w=l(b,g,x,!1,k,"4bdd705e",null,null);function k(e){for(let s in c)this[s]=c[s]}var U=function(){return w.exports}();export{U as default};

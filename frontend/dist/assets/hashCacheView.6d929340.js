import{t as n}from"./fc_tile.3a9af7b3.js";import{F as d}from"./fileUploader.488e7b50.js";import{n as c}from"./index.4edc165d.js";import"./vendor.6aa46313.js";var h=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"cont"},[t("v-row",{staticClass:"align-center"},[t("v-col",[t("v-card-title",{staticClass:"py-2"},[t("v-text-field",{attrs:{clearable:"",flat:"",outlined:"","prepend-inner-icon":"mdi-database-search",label:"Search by password or hash","single-line":"","hide-details":""},model:{value:e.search,callback:function(a){e.search=a},expression:"search"}})],1)],1),t("v-col",[e.selectedHashes.length>0?t("v-btn",{staticClass:"mr-2",attrs:{text:""},on:{click:e.multiDelete}},[t("v-icon",{attrs:{left:""}},[e._v(" mdi-delete ")]),e._v(" Delete ")],1):e._e(),t("v-btn",{staticClass:"mr-2",attrs:{text:""},on:{click:function(a){e.uploadCrackedHashesDialog=!0}}},[t("v-icon",{attrs:{left:""}},[e._v(" mdi-import ")]),e._v(" Import cracked hashes ")],1),t("v-btn",{staticClass:"mr-2",attrs:{text:""},on:{click:e.exportAllCrackedHashes}},[t("v-icon",{attrs:{left:""}},[e._v(" mdi-export ")]),e._v(" Export all cracked hashes ")],1)],1)],1),t("v-divider"),t("v-data-table",{ref:"table",attrs:{headers:e.headers,items:e.hashes,search:e.search,options:e.pagination,"server-items-length":e.totalItems,loading:e.loading,"footer-props":{itemsPerPageOptions:[15,30,50,{value:e.totalItems,text:"All"}],itemsPerPageText:"Hashes per page"},"items-per-page":15,"show-select":"","fixed-header":""},on:{"update:options":function(a){e.pagination=a}},scopedSlots:e._u([{key:"item.password",fn:function(a){var s=a.item;return[e._v(" "+e._s(s.password||"\u2013")+" ")]}},{key:"item.hash",fn:function(a){var s=a.item;return[t("div",{staticClass:"d-flex align-center mw-50"},[t("v-dialog",{attrs:{"max-width":"600"},scopedSlots:e._u([{key:"activator",fn:function(o){var l=o.on;return[t("span",e._g({staticClass:"text-truncate d-inline-block"},l),[e._v(" "+e._s(s.hash)+" ")])]}}],null,!0)},[t("v-card",[t("v-card-title",{attrs:{"primary-title":""}},[e._v(" "+e._s(s.hash_type_name)+" ")]),t("v-card-text",[e._v(" "+e._s(s.hash)+" ")])],1)],1)],1)]}},{key:"item.added",fn:function(a){var s=a.item;return[e._v(" "+e._s(e.$moment.utc(s.added).local().format("D.M.YYYY H:mm:ss"))+" ")]}},{key:"item.job",fn:function(a){var s=a.item;return[s.job?t("div",[t("router-link",{staticClass:"middle",attrs:{to:{name:"jobDetail",params:{id:s.job.id}}}},[e._v(" "+e._s(s.job.name)+" ")])],1):e._e()]}}]),model:{value:e.selectedHashes,callback:function(a){e.selectedHashes=a},expression:"selectedHashes"}}),t("v-dialog",{attrs:{"max-width":"400px"},model:{value:e.uploadCrackedHashesDialog,callback:function(a){e.uploadCrackedHashesDialog=a},expression:"uploadCrackedHashesDialog"}},[t("v-card",[t("v-card-title",[t("h2",[e._v("Upload cracked hashes")])]),t("v-alert",{staticClass:"mb-0",attrs:{tile:"",text:"",type:"warning"}},[e._v(" Imported files must have a .csv extension. Expected CSV header: Hash,Hash type,Password ")]),t("v-card-text",[t("file-uploader",{attrs:{url:this.$serverAddr+"/hashes/importCrackedHashes"},on:{uploadComplete:function(a){e.uploadCrackedHashesDialog=!1,e.loadHashes()}}})],1),t("v-card-actions",[t("v-spacer"),t("v-btn",{attrs:{color:"primary",text:""},on:{click:function(a){a.stopPropagation(),e.uploadCrackedHashesDialog=!1}}},[e._v(" Cancel ")])],1)],1)],1)],1)},p=[];const u={name:"HashesView",components:{FileUploader:d,"fc-tile":n},data:function(){return{interval:null,status:"active",search:"",totalItems:0,pagination:{},loading:!0,uploadCrackedHashesDialog:!1,selectedHashes:[],headers:[{text:"Username",value:"username",align:"start",sortable:!0},{text:"Hash type",value:"hash_type_name",align:"start",sortable:!0},{text:"Hash",value:"hash",align:"start",sortable:!0},{text:"Password",value:"password",align:"start",sortable:!0},{text:"Job",value:"job",align:"end",sortable:!0}],hashes:[]}},watch:{pagination:{handler(){this.loading=!0,this.loadHashes()},deep:!0}},mounted(){this.interval=setInterval(function(){this.loadHashes()}.bind(this),5e3)},beforeDestroy:function(){clearInterval(this.interval)},methods:{loadHashes(){this.axios.get(this.$serverAddr+"/hashes",{params:{page:this.pagination.page,per_page:this.pagination.itemsPerPage,order_by:this.pagination.sortBy[0],descending:this.pagination.sortDesc[0],search:this.search}}).then(e=>{this.hashes=e.data.items,this.totalItems=e.data.total,this.loading=!1})},updateStatus:function(e){this.status=e,this.$refs.table.updatePagination({page:1,totalItems:this.totalItems})},exportAllCrackedHashes(){this.axios.get(this.$serverAddr+"/hashes/exportCrackedHashes").then(e=>{const r=window.URL.createObjectURL(new Blob([e.data])),t=document.createElement("a");t.href=r,t.setAttribute("download","cracked_hashes.csv"),document.body.appendChild(t),t.click()}).catch(e=>{console.error("Error downloading file:",e)})},multiDelete(){this.selectedHashes.length!=0&&(this.loading=!0,this.axios.patch(this.$serverAddr+"/hashes",{hash_ids:this.selectedHashes.map(e=>e.id)}).then(e=>{this.loadHashes()}))}}},i={};var v=c(u,h,p,!1,m,"818a8b1a",null,null);function m(e){for(let r in i)this[r]=i[r]}var b=function(){return v.exports}();export{b as default};

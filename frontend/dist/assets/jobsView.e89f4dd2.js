var f=Object.defineProperty,g=Object.defineProperties;var x=Object.getOwnPropertyDescriptors;var u=Object.getOwnPropertySymbols;var k=Object.prototype.hasOwnProperty,y=Object.prototype.propertyIsEnumerable;var v=(t,i,e)=>i in t?f(t,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[i]=e,l=(t,i)=>{for(var e in i||(i={}))k.call(i,e)&&v(t,e,i[e]);if(u)for(var e of u(i))y.call(i,e)&&v(t,e,i[e]);return t},c=(t,i)=>g(t,x(i));import{a as m,j as w}from"./iconMaps.0c6dd037.js";import{m as C}from"./spyfu-vuex-helpers.esm.87da45d6.js";import{n as d,t as $}from"./index.70a8f19e.js";import{i as J,j,k as B}from"./vendor.6aa46313.js";import{h as S}from"./hostEditor.5ece68cb.js";import{f as T}from"./numberFormat.773889d3.js";import{d as z}from"./vuedraggable.umd.f0e73259.js";import"./hostSelector.dd56c76b.js";import"./index.0d13dead.js";import"./index.8ca51e37.js";import"./selectorMixin.45cc765c.js";var I=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 491 453"}},[e("path",{attrs:{fill:"#FFCBAD",stroke:"#F17734","stroke-width":"15",d:"M381.6 83.35H112.37c-4.3 0-8.3 2.2-10.58 5.84l-92.38 147a12.5 12.5 0 00-1.92 6.65v189.4c0 6.91 5.6 12.5 12.5 12.5h450.02c6.9 0 12.5-5.59 12.5-12.5V242.8c0-2.28-.62-4.5-1.79-6.45L392.3 89.4a12.5 12.5 0 00-10.7-6.05z"}}),e("path",{attrs:{fill:"#FF975E",d:"M381.41 207.61H112.57a5 5 0 00-4.38 2.58L19.11 370.93a5 5 0 004.38 7.43H466.7a5 5 0 004.42-7.35l-85.3-160.74a5 5 0 00-4.42-2.66z"}}),e("mask",{attrs:{id:"a",width:"491",height:"224",x:"0",y:"226.4",fill:"#000",maskUnits:"userSpaceOnUse"}},[e("path",{attrs:{fill:"#fff",d:"M0 226.4h491v224H0z"}}),e("path",{attrs:{"fill-rule":"evenodd",d:"M189.61 285.43a5 5 0 01-4.59-3.03l-16.36-37.98a5 5 0 00-4.59-3.02H20a5 5 0 00-5 5v183.87a5 5 0 005 5h450.02a5 5 0 005-5V246.4a5 5 0 00-5-5H325.95a5 5 0 00-4.59 3.02l-16.35 37.98a5 5 0 01-4.6 3.03h-110.8z","clip-rule":"evenodd"}})]),e("path",{attrs:{fill:"#F3F3F3","fill-rule":"evenodd",d:"M189.61 285.43a5 5 0 01-4.59-3.03l-16.36-37.98a5 5 0 00-4.59-3.02H20a5 5 0 00-5 5v183.87a5 5 0 005 5h450.02a5 5 0 005-5V246.4a5 5 0 00-5-5H325.95a5 5 0 00-4.59 3.02l-16.35 37.98a5 5 0 01-4.6 3.03h-110.8z","clip-rule":"evenodd"}}),e("path",{attrs:{fill:"#F17734",d:"M185.02 282.4l-13.78 5.94 13.78-5.94zm119.99 0l-13.78-5.93 13.78 5.93zm16.35-37.98l-13.78-5.93 13.78 5.93zm-152.7 0l13.78-5.93-13.78 5.93zm2.58 43.92a20 20 0 0018.37 12.09v-30a10 10 0 019.19 6.04l-27.56 11.87zm-16.35-37.99l16.35 37.99 27.56-11.87-16.36-37.98-27.55 11.86zM20 256.4h144.07v-30H20v30zm10 173.87V246.4H0v183.87h30zm440.02-10H20v30h450.02v-30zm-10-173.87v183.87h30V246.4h-30zm-134.07 10h144.07v-30H325.95v30zm-7.16 31.94l16.35-37.99-27.56-11.86-16.35 37.98 27.56 11.86zm-18.38 12.09a20 20 0 0018.38-12.1l-27.56-11.86a10 10 0 019.19-6.04v30zm-110.8 0h110.8v-30h-110.8v30zm136.34-74.03a20 20 0 00-18.37 12.09l27.56 11.86a10 10 0 01-9.19 6.05v-30zm164.07 20a20 20 0 00-20-20v30a10 10 0 01-10-10h30zm-20 203.87a20 20 0 0020-20h-30a10 10 0 0110-10v30zM0 430.27a20 20 0 0020 20v-30a10 10 0 0110 10H0zM20 226.4a20 20 0 00-20 20h30a10 10 0 01-10 10v-30zm162.44 12.09a20 20 0 00-18.37-12.1v30a10 10 0 01-9.18-6.04l27.55-11.86z",mask:"url(#a)"}}),e("path",{attrs:{fill:"#978DCE","fill-rule":"evenodd",d:"M204.36 317.48l7.7 3.6-9.3 6.5 10.29 4.8-9.16 6.4 10.13 4.73-9.2 6.45L215 354.7l-9.3 6.5 10.3 4.8-9.16 6.41 10.13 4.72-9.22 6.45 10.2 4.76-9.3 6.5 10.28 4.8-9.15 6.4 10.13 4.73-8.3 5.8 263.54-24.25v-96.21l-270.79 21.36z","clip-rule":"evenodd"}}),e("mask",{attrs:{id:"b",width:"283",height:"124",x:"201",y:"293",maskUnits:"userSpaceOnUse"}},[e("path",{attrs:{fill:"#978DCE",d:"M201.85 317.68l273.3-21.56v96.2L210.52 416.7l-8.67-99.01z"}})]),e("g",{attrs:{mask:"url(#b)"}},[e("text",{staticStyle:{"white-space":"pre"},attrs:{fill:"#F3F3F3","font-family":"Roboto","font-size":"62",transform:"rotate(-5 3929.07 -2466.62)","letter-spacing":"0em"}},[e("tspan",{attrs:{x:"0",y:"52"}},[t._v(t._s(t.label))])])])])},A=[];const E={props:{label:{type:String,default:"Job bin #1"}}},h={};var F=d(E,I,A,!1,L,null,null,null);function L(t){for(let i in h)this[i]=h[i]}var O=function(){return F.exports}(),H=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("v-card",[e("v-card-title",[t._v(" Prepare Job Queue ")]),e("v-card-text",[e("v-row",{staticClass:"align-center"},[e("v-col",{attrs:{cols:"8"}},[t._v(" Jobs will run in sequence as listed. Change the order by dragging them or select a sort. ")]),e("v-col",{attrs:{cols:"4"}},[e("v-select",{attrs:{label:"Sort",outlined:"","hide-details":"",items:t.sorts},on:{change:t.sortQueue},model:{value:t.sorting,callback:function(s){t.sorting=s},expression:"sorting"}})],1)],1),e("draggable",{attrs:{animation:150},on:{change:function(s){t.sorting=void 0}},model:{value:t.queue,callback:function(s){t.queue=s},expression:"queue"}},t._l(t.queue,function(s){var a=s.id,n=s.name,r=s.keyspace,o=s.hc_keyspace,_=s.attack;return e("v-list-item",{key:a,staticClass:"hand"},[e("v-list-item-action",[e("v-icon",[t._v(t._s(t.attackIcon(_)))])],1),e("v-list-item-content",[e("v-list-item-title",{staticClass:"font-weight-bold",style:{color:t.identColor(a,r)}},[t._v(" "+t._s(n)+" ")]),e("v-list-item-subtitle",[e("v-icon",{attrs:{"x-small":""}},[t._v(" mdi-key ")]),e("span",[t._v(t._s(t.numberFormat(r))+" possible passwords")]),e("span",[t._v("(computing "),e("strong",[t._v(t._s(t.numberFormat(o)))]),t._v(")")])],1)],1),e("v-list-item-action",[e("v-btn",{attrs:{text:"",disabled:t.queue.length<=2},on:{click:function(G){return t.deselect(a)}}},[e("span",[t._v("Unqueue")]),e("v-icon",{attrs:{right:""}},[t._v(" mdi-tray-remove ")])],1)],1)],1)}),1)],1),e("transition-group",{staticClass:"d-flex mx-6 mb-4",attrs:{tag:"div",name:"ks-graph"}},t._l(t.queue,function(s){var a=s.id,n=s.name,r=s.keyspace,o=s.hc_keyspace;return e("div",{key:n,staticClass:"ks subtitle-2",style:{flexGrow:o}},[e("div",{staticClass:"ks-number",style:{backgroundColor:t.identColor(a,r)}},[t._v(" "+t._s(t.numberFormat(o))+" ")])])}),0),e("v-card-actions",{staticClass:"align-center"},[e("v-btn",{attrs:{text:""},on:{click:function(s){return t.$emit("close")}}},[e("v-icon",{attrs:{left:""}},[t._v(" mdi-close ")]),e("span",[t._v("Cancel")])],1),e("v-spacer"),e("v-text-field",{staticClass:"mr-2",attrs:{label:"Batch name","hide-details":"",outlined:"",dense:""},model:{value:t.batchName,callback:function(s){t.batchName=s},expression:"batchName"}}),e("v-btn",{attrs:{color:"success",disabled:t.batchName==="",loading:t.submitting},on:{click:t.submit}},[e("span",[t._v("Create Batch")]),e("v-icon",{attrs:{right:""}},[t._v(" mdi-tray-plus ")])],1)],1)],1)},M=[];const N={components:{draggable:z},props:{jobs:{type:Array,default:()=>[]}},data(){return{queue:[],batchName:"",sorts:[{text:"Fastest first",value:{by:"hc_keyspace",asc:!0}},{text:"Slowest first",value:{by:"hc_keyspace",asc:!1}},{text:"Less passwords first",value:{by:"keyspace",asc:!0}},{text:"More passwords first",value:{by:"keyspace",asc:!1}},{text:"Newest first",value:{by:"time",asc:!1}},{text:"Oldest first",value:{by:"time",asc:!0}}],sorting:void 0,submitting:!1}},watch:{jobs:{immediate:!0,handler(t){this.queue=t.filter(i=>i.status==0&&!i.batch_id),this.sorting&&this.sortQueue(this.sorting)}}},methods:{numberFormat:T,attackIcon:m,identColor(t,i){return`hsl(${t*i}, 65%, 45%)`},sortQueue({by:t,asc:i}){this.queue.sort((e,s)=>{let a,n;return t==="time"?(a=this.$moment(e[t]).unix(),n=this.$moment(s[t]).unix()):(a=parseInt(e[t]),n=parseInt(s[t])),i?a-n:n-a})},deselect(t){this.queue=this.queue.filter(i=>i.id!=t)},async submit(){this.submitting=!0;try{const t=await this.axios.put(this.$serverAddr+"/batches",{name:this.batchName,jobs:this.queue.map(i=>i.id)}).then(i=>i.data);this.$store.commit("binInterface/selectedJobsMut",[]),this.$router.push(`/batches/${t}`)}catch(t){console.error(t)}finally{this.submitting=!1}}}},p={};var P=d(N,H,M,!1,q,"42db655a",null,null);function q(t){for(let i in p)this[i]=p[i]}var D=function(){return P.exports}(),R=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",[e("v-toolbar",{attrs:{flat:""}},[e("v-chip",[e("v-fade-transition",{attrs:{mode:"out-in"}},[t.loading?e("v-progress-circular",{staticClass:"back-margin",attrs:{size:"16",width:"2",indeterminate:""}}):e("span",[t._v(" "+t._s(t.totalItems)+" ")])],1)],1),e("h2",{staticClass:"ml-4"},[t._v(" "+t._s(t.binTitle)+" "),e("span",{directives:[{name:"show",rawName:"v-show",value:t.$vuetify.breakpoint.lgAndUp,expression:"$vuetify.breakpoint.lgAndUp"}],staticClass:"text--secondary"},[e("span",{directives:[{name:"show",rawName:"v-show",value:t.status||t.attackType,expression:"status || attackType"}]},[t._v("that ")]),e("span",{directives:[{name:"show",rawName:"v-show",value:t.status,expression:"status"}]},[t._v("are "+t._s(t.status))]),e("span",{directives:[{name:"show",rawName:"v-show",value:t.status&&t.attackType,expression:"status && attackType"}]},[t._v(" and ")]),e("span",{directives:[{name:"show",rawName:"v-show",value:t.attackType,expression:"attackType"}]},[t._v("use "+t._s(t.attackType)+" attack")])])]),e("v-spacer"),t.isBin&&t.$userCan("EDIT_ALL_JOBS")?e("div",[e("transition",{attrs:{name:"fade",mode:"out-in"},on:{enter:t.focusRenameInput}},[t.renamingBin?e("div",{key:"renameBinPanel",staticClass:"d-flex align-center"},[e("v-text-field",{ref:"binRenameField",staticClass:"mr-2",attrs:{placeholder:t.bin.name,"hide-details":""},on:{keydown:t.renameBinKeyHandler},model:{value:t.newBinName,callback:function(s){t.newBinName=s},expression:"newBinName"}}),e("v-btn",{attrs:{text:""},on:{click:t.renameBinExec}},[e("v-icon",{attrs:{left:""}},[t._v(" mdi-content-save ")]),t._v(" Save ")],1),e("v-btn",{attrs:{text:"",ripple:!1},on:{click:function(s){t.renamingBin=!1}}},[e("v-icon",{attrs:{left:""}},[t._v(" mdi-undo-variant ")]),t._v(" Cancel ")],1)],1):e("div",{key:"binActionsPanel"},[e("v-btn",{attrs:{text:"",ripple:!1},on:{click:function(s){t.renamingBin=!0}}},[e("v-icon",{attrs:{left:""}},[t._v(" mdi-pencil ")]),t._v(" Rename Bin ")],1),e("v-btn",{attrs:{text:""},on:{click:t.deleteBinConfirm}},[e("v-icon",{attrs:{left:""}},[t._v(" mdi-delete ")]),t._v(" Delete Bin ")],1)],1)])],1):t._e()],1),e("div",{staticClass:"overflow-hidden toolbar-cont"},[e("transition",{attrs:{name:"swap"}},[t.selectedJobs.length==0?e("div",{key:"filtersToolbar",staticClass:"toolbar-module d-flex justify-space-between align-center px-2"},[e("v-text-field",{staticClass:"mx-2 search-field",attrs:{clearable:"","prepend-icon":"mdi-table-search",label:"Search","single-line":""},on:{input:t.updateList},model:{value:t.search,callback:function(s){t.search=s},expression:"search"}}),e("v-select",{staticClass:"mx-2",attrs:{items:t.jobs_statuses,label:"Status","single-line":"","item-text":"text","item-value":"text","prepend-icon":"mdi-timelapse",clearable:""},on:{change:t.updateList},model:{value:t.status,callback:function(s){t.status=s},expression:"status"}}),e("v-select",{staticClass:"mx-2",attrs:{items:t.jobs_types,label:"Attack type","single-line":"","item-text":"text","item-value":"text","prepend-icon":"mdi-crosshairs-gps",clearable:""},on:{change:t.updateList},model:{value:t.attackType,callback:function(s){t.attackType=s},expression:"attackType"}})],1):e("div",{key:"selectionToolbar",staticClass:"toolbar-module d-flex align-center swap-pad"},[e("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(s){var a=s.on;return[e("v-btn",t._g({staticClass:"mr-2",attrs:{id:"batch-creator-open",text:"",color:"success",disabled:t.selectedJobs.filter(function(n){return n.status==0&&!n.batch_id}).length<2},on:{click:function(n){t.batchCreatorOpen=!0}}},a),[e("v-icon",{attrs:{left:""}},[t._v(" mdi-tray-plus ")]),t._v(" Batch Run ")],1)]}}])},[e("span",[t._v("Only "),e("strong",{staticClass:"info--text"},[t._v("ready")]),t._v(" jobs can be added")])]),e("v-btn",{staticClass:"mr-2",attrs:{id:"host-mapper-open",text:"",color:"warning"},on:{click:function(s){t.hostEditorOpen=!0}}},[e("v-icon",{attrs:{left:""}},[t._v(" mdi-desktop-classic ")]),t._v(" Hosts ")],1),e("v-btn",{staticClass:"mr-2",attrs:{text:""},on:{click:t.exportAdd}},[e("v-icon",{attrs:{left:""}},[t._v(" mdi-package-variant ")]),t._v(" Add to Export ")],1),e("v-btn",{staticClass:"mr-2",attrs:{text:""},on:{click:t.multiTrash}},[e("v-icon",{attrs:{left:""}},[t._v(" "+t._s(t.isTrash?"mdi-delete-restore":"mdi-delete")+" ")]),t._v(" "+t._s(t.isTrash?"Restore":"Delete")+" ")],1),e("v-btn",{staticClass:"mr-2",attrs:{text:""},on:{click:t.multiStart}},[e("v-icon",{attrs:{left:""}},[t._v(" mdi-play ")]),t._v(" Start ")],1),e("v-btn",{staticClass:"mr-2",attrs:{text:""},on:{click:t.multiStop}},[e("v-icon",{attrs:{left:""}},[t._v(" mdi-stop ")]),t._v(" Stop ")],1),e("v-btn",{staticClass:"mr-2",attrs:{text:""},on:{click:t.multiPurge}},[e("v-icon",{attrs:{left:""}},[t._v(" mdi-undo-variant ")]),t._v(" Purge ")],1)],1)])],1),e("v-divider"),!t.loading&&t.binEmpty?e("div",{staticClass:"text-center mt-8 pa-8 detail-container"},[e("h1",[t._v("You had one job. And you binned it.")]),e("bin-illust",{staticClass:"illust",attrs:{label:t.bin.name}}),e("v-card",{staticClass:"text-start",attrs:{flat:""}},[e("v-card-title",[t._v("Here's how:")]),e("v-card-text",[e("ol",[e("li",[t._v("List "),e("router-link",{attrs:{to:"/jobs"}},[e("i",{staticClass:"mdi mdi-briefcase"}),t._v(" "),e("em",[t._v("All Jobs")])]),t._v(" or another bin")],1),e("li",[t._v("Check "),e("i",{staticClass:"mdi mdi-checkbox-marked-outline"}),t._v(" the jobs you want to add here")]),e("li",[t._v("Select "),e("span",{staticClass:"success--text"},[e("i",{staticClass:"mdi mdi-plus"}),t._v(" "),e("em",[t._v("Add to "+t._s(t.bin.name))])]),t._v(" in the sidebar")])])])],1)],1):t._e(),e("v-data-table",{directives:[{name:"show",rawName:"v-show",value:!t.binEmpty,expression:"!binEmpty"}],ref:"table",attrs:{id:"jobs-table",headers:t.headers,items:t.jobs,search:t.search,options:t.pagination,"server-items-length":t.totalItems,"footer-props":{itemsPerPageOptions:[15,30,50,{value:t.totalItems,text:"All"}],itemsPerPageText:"Jobs per page"},"items-per-page":15,"show-select":"","fixed-header":""},on:{"update:options":function(s){t.pagination=s}},scopedSlots:t._u([{key:"item.name",fn:function(s){var a=s.item;return[e("router-link",{staticClass:"table-link",attrs:{to:{name:"jobDetail",params:{id:a.id}}}},[e("span",[t._v(t._s(a.name))]),a.batch_id?e("v-icon",{attrs:{right:"",small:"",color:"primary"}},[t._v(" mdi-tray-full ")]):t._e()],1)]}},{key:"item.attack",fn:function(s){var a=s.item;return[e("span",{staticClass:"text-capitalize"},[t._v(" "+t._s(a.attack)+" "),e("v-icon",{attrs:{right:""}},[t._v(" "+t._s(t.attackIcon(a.attack))+" ")])],1)]}},{key:"item.status",fn:function(s){var a=s.item;return[a.batch_id&&a.status==0?e("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(n){var r=n.on;return[e("router-link",{attrs:{to:"/batches/"+a.batch_id}},[e("span",t._g({staticClass:"text-capitalize"},r),[t._v(" enqueued "),e("v-icon",{attrs:{right:"",color:"primary"}},[t._v(" mdi-timetable ")])],1)])]}}],null,!0)},[e("span",[t._v("This job is waiting in queue. Click to see the batch.")])]):a.host_count>0?e("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(n){var r=n.on;return[e("span",t._g({class:[a.status_type+"--text","text-capitalize"]},r),[t._v(" "+t._s(a.status_text)+" "),e("v-icon",{attrs:{right:"",color:a.status_type}},[t._v(" "+t._s(t.jobIcon(a.status_text))+" ")])],1)]}}],null,!0)},[e("span",[t._v(t._s(a.status_tooltip))])]):e("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(n){var r=n.on;return[e("span",t._g({staticClass:"text-capitalize"},r),[t._v(" no hosts "),e("v-icon",{attrs:{right:""}},[t._v(" mdi-alert ")])],1)]}}],null,!0)},[e("span",[t._v("No hosts, open job detail and assign them!")])])]}},{key:"item.progress",fn:function(s){var a=s.item;return[e("div",{staticClass:"d-flex align-center justify-end"},[e("span",{staticClass:"mr-2"},[t._v(t._s(t.progressToPercentage(a.progress)))]),e("v-progress-circular",{staticClass:"jobProgress",attrs:{size:"18",width:3,rotate:270,color:"primary",value:a.progress}})],1)]}},{key:"item.time",fn:function(s){var a=s.item;return[t._v(" "+t._s(t.$moment.utc(a.time).local().format("D.M.YYYY H:mm:ss"))+" ")]}},{key:"item.actions",fn:function(s){var a=s.item;return[e("div",{staticClass:"actionsBtns"},[a.batch_id!=null&&(a.status==0||a.status>=10)?e("v-btn",{attrs:{text:"",color:"primary",to:"/batches/"+a.batch_id}},[t._v(" Go to Batch "),e("v-icon",{attrs:{right:""}},[t._v(" mdi-tray-full ")])],1):a.permissions.operate||t.$userCan("OPERATE_ALL_JOBS")?[a.status==="0"?e("v-btn",{attrs:{disabled:a.host_count==0,text:"",color:"success"},on:{click:function(n){return t.operateJob(a.id,"start")}}},[t._v(" Start "),e("v-icon",{attrs:{right:""}},[t._v(" mdi-play ")])],1):a.status<10?e("v-btn",{attrs:{disabled:a.host_count==0,text:"",color:"info"},on:{click:function(n){return t.operateJob(a.id,"restart")}}},[t._v(" Restart "),e("v-icon",{attrs:{right:""}},[t._v(" mdi-restart ")])],1):e("v-btn",{attrs:{text:"",color:"error",disabled:a.status==="12"},on:{click:function(n){return t.operateJob(a.id,"stop")}}},[t._v(" Stop "),e("v-icon",{attrs:{right:""}},[t._v(" mdi-stop ")])],1)]:t._e(),e("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(n){var r=n.on;return[a.permissions.edit||t.$userCan("EDIT_ALL_JOBS")?e("v-btn",t._g({staticClass:"mx-0",attrs:{icon:""},on:{click:function(o){return t.hideJob(a.id)}}},r),[e("v-icon",[t._v(" "+t._s(t.isTrash?"mdi-delete-restore":"mdi-delete")+" ")])],1):t._e()]}}],null,!0)},[e("span",[t._v(t._s(t.isTrash?"Restore":"Delete"))])])],2)]}},{key:"footer.page-text",fn:function(s){var a=s.pageStart,n=s.pageStop,r=s.itemsLength;return[e("strong",[t._v("Page "+t._s(t.pagination.page))]),t._v(" \u2013 "+t._s(a)+"-"+t._s(n)+" of "+t._s(r)+" ")]}}]),model:{value:t.selectedJobs,callback:function(s){t.selectedJobs=s},expression:"selectedJobs"}}),e("host-editor",{attrs:{"job-ids":t.selectedJobs.map(function(s){return s.id})},on:{reload:t.updateList},model:{value:t.hostEditorOpen,callback:function(s){t.hostEditorOpen=s},expression:"hostEditorOpen"}}),e("v-dialog",{attrs:{"max-width":"900"},model:{value:t.batchCreatorOpen,callback:function(s){t.batchCreatorOpen=s},expression:"batchCreatorOpen"}},[e("batch-creator",{attrs:{jobs:t.selectedJobs},on:{close:function(s){t.batchCreatorOpen=!1}}})],1)],1)},V=[];const U={name:"JobsView",components:{BinIllust:O,HostEditor:S,BatchCreator:D},data(){return{interval:null,renamingBin:!1,newBinName:null,hostEditorOpen:!1,batchCreatorOpen:!1,status:null,attackType:null,search:"",totalItems:0,pagination:{},loading:!0,headers:[{text:"Name",align:"start",value:"name"},{text:"Attack type",value:"attack",align:"end",sortable:!1},{text:"Status",value:"status",align:"end"},{text:"Progress",value:"progress",align:"end"},{text:"Added",value:"time",align:"end"},{text:"Actions",value:"actions",sortable:!1,align:"end"}],jobs_statuses:[{text:"ready",code:0},{text:"finished",code:1},{text:"exhausted",code:2},{text:"malformed",code:3},{text:"timeout",code:4},{text:"running",code:10},{text:"finishing",code:12}],jobs_types:[{text:"dictionary",code:0},{text:"mask",code:1},{text:"combinator",code:2},{text:"pcfg",code:3},{text:"prince",code:4},{text:"hybrid (wordlist + mask)",code:5},{text:"hybrid (mask + wordlist)",code:6}],jobs:[]}},computed:c(l(l({},J("binInterface",["clean"])),C("binInterface",$(["selectedJobs"]))),{isTrash(){return this.$route.params.id==="trash"},isBin(){return this.$route.name==="bins"&&!this.isTrash},binId(){return parseInt(this.$route.params.id)},bin(){return this.$store.state.binInterface.bins.find(t=>t.id==this.binId)},binTitle(){return this.bin?this.bin.name:this.isTrash?"Deleted Jobs":this.$userCan("VIEW_ALL_JOBS")?"All Jobs":"My Jobs"},binEmpty(){return this.bin&&this.bin.job_count==0}}),watch:{pagination:{deep:!0,handler({page:t}){this.$paginator(this.$route.path,t),this.updateList(!1)}},$route({path:t}){this.pagination.page=this.$paginator(t),this.status=null,this.attackType=null,this.search="",this.updateList(!1)},clean(t){t||(this.updateList(!1),this.$store.commit("binInterface/clean"))}},mounted(){this.pagination.page=this.$paginator(this.$route.path),this.interval=setInterval(()=>{this.loadJobs()},5e3),window.addEventListener("keydown",this.shortcutHandler)},beforeDestroy:function(){this.selectedJobs=[],clearInterval(this.interval),window.removeEventListener("keydown",this.shortcutHandler)},methods:c(l(l({},j("transfer",{addJobsForTransfer:"add"})),B("binInterface",{renameBin:"rename",deleteBin:"delete"})),{async loadJobs(){const t=await this.axios.get(this.$serverAddr+"/job",{params:{page:this.pagination.page,per_page:this.pagination.itemsPerPage,order_by:this.pagination.sortBy[0],descending:this.pagination.sortDesc[0],name:this.search,status:this.status,attack_mode:this.attackType,showDeleted:this.isTrash,bin:this.binId||null}}).then(i=>i.data);this.jobs=t.items,this.totalItems=t.total,this.loading=!1},updateList(t=!0){t&&(this.pagination.page=1),this.selectedJobs=[],this.loading=!0,this.loadJobs()},updateStatus:function(t){this.status=t,this.$refs.table.updatePagination({page:1,totalItems:this.totalItems})},progressToPercentage:function(t){return t>100&&(t=100),t.toFixed()+"%"},operateJob:function(t,i){this.axios.get(this.$serverAddr+"/job/"+t+"/action",{params:{operation:i}}).then(e=>{console.log(e.data),this.loadJobs()})},hideJob:function(t){this.loading=!0,this.axios.delete(this.$serverAddr+"/job/"+t).then(i=>{this.loadJobs()})},multiTrash(){this.selectedJobs.length!=0&&(this.loading=!0,this.axios.patch(this.$serverAddr+"/job",{job_ids:this.selectedJobs.map(t=>t.id)}).then(t=>{this.loadJobs()}))},multiStop(){this.selectedJobs.length!=0&&(this.loading=!0,this.axios.post(this.$serverAddr+"/job/multiJobOperation",{job_ids:this.selectedJobs.map(t=>t.id),operation:"stop"}).then(t=>{this.loadJobs()}))},multiStart(){this.selectedJobs.length!=0&&(this.loading=!0,this.axios.post(this.$serverAddr+"/job/multiJobOperation",{job_ids:this.selectedJobs.map(t=>t.id),operation:"start"}).then(t=>{this.loadJobs()}))},multiPurge(){this.selectedJobs.length!=0&&(this.loading=!0,this.axios.post(this.$serverAddr+"/job/multiJobOperation",{job_ids:this.selectedJobs.map(t=>t.id),operation:"kill"}).then(t=>{this.loadJobs()}))},focusRenameInput(){this.renamingBin&&this.$refs.binRenameField.focus()},renameBinExec(){this.renameBin({id:this.binId,newName:this.newBinName}).then(()=>{this.renamingBin=!1})},renameBinKeyHandler({keyCode:t}){switch(t){case 13:this.renameBinExec();break;case 27:this.renamingBin=!1;break}},deleteBinConfirm(){this.$root.$confirm("Delete Bin",`This will remove ${this.bin.name}. Jobs will be unassigned from the deleted bin, but will not be deleted. Are you sure?`).then(t=>{this.deleteBin(this.binId)})},exportAdd(){this.addJobsForTransfer(this.selectedJobs)},jobIcon:w,attackIcon:m,shortcutHandler(t){t.key==="Delete"&&this.isBin&&this.deleteBinConfirm()}})},b={};var Y=d(U,R,V,!1,Q,"82f1ebf6",null,null);function Q(t){for(let i in b)this[i]=b[i]}var lt=function(){return Y.exports}();export{lt as default};

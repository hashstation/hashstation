import{D as H}from"./datetime.498a4c0d.js";import{n as o}from"./index.5bde66b2.js";import{j as d,a as m}from"./iconMaps.0c6dd037.js";import{f as l}from"./numberFormat.773889d3.js";import{g as u}from"./timeseries.9158092b.js";import{f as S}from"./hs_textarea.e32184e3.js";import{h as E}from"./hostEditor.cfc2e99e.js";import{j as M}from"./jobProgress.e9b74022.js";import{w as P}from"./jobWorkunits.97f2afca.js";import{c as A}from"./jobContribution.b955ce99.js";import{t as c}from"./hs_tile.7156f8b8.js";import"./vendor.6aa46313.js";import"./vue-infinite-loading.33b09e95.js";import"./hostSelector.d1bf0d8a.js";import"./index.83b43bd6.js";import"./index.53b1cba6.js";import"./selectorMixin.45cc765c.js";var Y=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",[e("v-list-item",[e("v-list-item-content",[e("v-text-field",{attrs:{outlined:"","hide-details":""},scopedSlots:t._u([{key:"label",fn:function(){return[e("v-icon",{staticClass:"label-icon"},[t._v(" mdi-format-title ")]),t._v(" Name ")]},proxy:!0}]),model:{value:t.edit.name,callback:function(a){t.$set(t.edit,"name",a)},expression:"edit.name"}})],1)],1),e("v-list-item",[e("v-list-item-content",{staticClass:"py-0"},[e("v-list-item-title",{staticClass:"d-flex align-center"},[e("div",{staticClass:"subtitle-2"},[e("v-icon",[t._v(" mdi-ray-start ")]),t._v(" Start ")],1),e("v-spacer"),e("v-checkbox",{attrs:{label:"No Start Delay"},model:{value:t.edit.startNow,callback:function(a){t.$set(t.edit,"startNow",a)},expression:"edit.startNow"}})],1),e("picker",{directives:[{name:"show",rawName:"v-show",value:!t.edit.startNow,expression:"!edit.startNow"}],attrs:{outlined:"","hide-details":""},model:{value:t.edit.time_start,callback:function(a){t.$set(t.edit,"time_start",a)},expression:"edit.time_start"}})],1)],1),e("v-list-item",[e("v-list-item-content",{staticClass:"pt-0"},[e("v-list-item-title",{staticClass:"d-flex align-center"},[e("div",{staticClass:"subtitle-2"},[e("v-icon",[t._v(" mdi-ray-end ")]),t._v(" End ")],1),e("v-spacer"),e("v-checkbox",{attrs:{label:"No Time Limit"},model:{value:t.edit.endNever,callback:function(a){t.$set(t.edit,"endNever",a)},expression:"edit.endNever"}})],1),e("picker",{directives:[{name:"show",rawName:"v-show",value:!t.edit.endNever,expression:"!edit.endNever"}],attrs:{outlined:"","hide-details":""},model:{value:t.edit.time_end,callback:function(a){t.$set(t.edit,"time_end",a)},expression:"edit.time_end"}})],1)],1),e("v-list-item",[e("v-list-item-content",[e("v-text-field",{attrs:{outlined:"","hide-details":"",type:"number",suffix:"seconds"},scopedSlots:t._u([{key:"label",fn:function(){return[e("v-icon",{staticClass:"label-icon"},[t._v(" mdi-timeline-clock ")]),t._v(" Time per workunit ")]},proxy:!0}]),model:{value:t.edit.seconds_per_job,callback:function(a){t.$set(t.edit,"seconds_per_job",a)},expression:"edit.seconds_per_job"}})],1)],1),e("v-list-item",[e("v-list-item-content",[e("v-textarea",{attrs:{outlined:"","auto-grow":"","hide-details":""},scopedSlots:t._u([{key:"label",fn:function(){return[e("v-icon",{staticClass:"label-icon"},[t._v(" mdi-format-quote-close ")]),t._v(" Comment ")]},proxy:!0}]),model:{value:t.edit.comment,callback:function(a){t.$set(t.edit,"comment",a)},expression:"edit.comment"}})],1)],1),t.data.attack_mode==8?[e("v-list-item",[e("v-list-item-content",[e("v-checkbox",{attrs:{label:"Check password duplicates"},model:{value:t.edit.check_duplicates,callback:function(a){t.$set(t.edit,"check_duplicates",a)},expression:"edit.check_duplicates"}}),e("v-checkbox",{attrs:{label:"Case permutation"},model:{value:t.edit.case_permute,callback:function(a){t.$set(t.edit,"case_permute",a)},expression:"edit.case_permute"}})],1)],1),e("v-list-item",[e("v-list-item-content",[e("v-text-field",{attrs:{outlined:"",label:"Minimal length of passwords (1 - 32)",required:"",type:"number",min:"1",max:"32"},model:{value:t.edit.min_password_len,callback:function(a){t.$set(t.edit,"min_password_len",a)},expression:"edit.min_password_len"}})],1)],1),e("v-list-item",[e("v-list-item-content",[e("v-text-field",{attrs:{outlined:"",label:"Maximal length of passwords (1 - 32)",required:"",type:"number",min:"1",max:"32"},model:{value:t.edit.max_password_len,callback:function(a){t.$set(t.edit,"max_password_len",a)},expression:"edit.max_password_len"}})],1)],1),e("v-list-item",[e("v-list-item-content",[e("v-text-field",{attrs:{outlined:"",label:"Minimal number of elements per chain (1 - 16)",required:"",type:"number",min:"1",max:"16"},model:{value:t.edit.min_elem_in_chain,callback:function(a){t.$set(t.edit,"min_elem_in_chain",a)},expression:"edit.min_elem_in_chain"}})],1)],1),e("v-list-item",[e("v-list-item-content",[e("v-text-field",{attrs:{outlined:"",label:"Maximal number of elements per chain (1 - 16)",required:"",type:"number",min:"1",max:"16"},model:{value:t.edit.max_elem_in_chain,callback:function(a){t.$set(t.edit,"max_elem_in_chain",a)},expression:"edit.max_elem_in_chain"}})],1)],1)]:t._e(),e("v-list-item",[e("v-list-item-content",[e("v-btn",{attrs:{color:"primary"},on:{click:t.save}},[e("v-icon",{attrs:{left:""}},[t._v(" mdi-content-save ")]),e("span",[t._v("Save")])],1)],1)],1)],2)},N=[];const T={components:{Picker:H},props:{data:{type:Object,default:()=>{}}},data(){return{edit:{name:this.data.name,comment:this.data.comment,seconds_per_job:this.data.seconds_per_job,time_start:this.data.time_start===null?this.$moment().format("YYYY-MM-DDTHH:mm"):this.$moment.utc(this.data.time_start).local().format("YYYY-MM-DDTHH:mm"),time_end:this.data.time_end===null?this.$moment().format("YYYY-MM-DDTHH:mm"):this.$moment.utc(this.data.time_end).local().format("YYYY-MM-DDTHH:mm"),startNow:this.data.time_start===null,endNever:this.data.time_end===null,check_duplicates:this.data.check_duplicates,case_permute:this.data.case_permute,min_password_len:this.data.min_password_len,max_password_len:this.data.max_password_len,min_elem_in_chain:this.data.min_elem_in_chain,max_elem_in_chain:this.data.max_elem_in_chain}}},methods:{save(){this.edit.startNow?this.edit.time_start="":this.edit.time_start=this.$moment(this.edit.time_start).utc().toISOString(!0).slice(0,16),this.edit.endNever?this.edit.time_end="":this.edit.time_end=this.$moment(this.edit.time_end).utc().toISOString(!0).slice(0,16),this.axios.put(this.$serverAddr+"/job/"+this.data.id,this.edit).then(t=>{this.$emit("save")})}}},v={};var O=o(T,Y,N,!1,R,"1db7bdf8",null,null);function R(t){for(let i in v)this[i]=v[i]}var I=function(){return O.exports}(),F=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"job-info"},[e("div",{staticClass:"sticky-wrap"},[e("v-sheet",{staticClass:"info-sheet top-sheet pa-4",attrs:{dark:"",tile:"",color:t.statusColor}},[e("v-icon",{staticClass:"attack-icon",attrs:{"aria-hidden":""}},[t._v(" "+t._s(t.attackIcon(t.data.attack))+" ")]),e("div",{staticClass:"top-sheet-bar mb-2"},[e("div",[e("div",{staticClass:"name title mb-2"},[t._v(" "+t._s(t.data.name)+" ")]),e("div",{staticClass:"subtitle-2 "},[e("b",{staticClass:"text-capitalize"},[t._v(t._s(t.data.attack))]),t._v(" Attack "),e("br"),e("b",[t._v(t._s(t.data.hash_type_name))])])])]),e("div",{staticClass:"status"},[e("v-progress-circular",{staticClass:"fu",attrs:{value:t.data.progress,indeterminate:t.indtProgress,size:"26",rotate:"-90"}}),e("span",{staticClass:"text-capitalize pt-1 ml-2"},[t.data.batch&&t.data.batch.id&&t.data.status==0?e("span",[t._v(" Enqueued ")]):e("span",[e("b",{directives:[{name:"show",rawName:"v-show",value:t.data.progress>0&&t.data.progress<100,expression:"data.progress > 0 && data.progress < 100"}]},[t._v(t._s(t.data.progress)+" %")]),t._v(" "+t._s(t.data.status_text)+" ")])])],1)],1),e("v-sheet",{staticClass:"info-sheet cta-sheet pa-2 d-flex",attrs:{dark:"",tile:"",color:t.statusColor}},[t.editing?[t.data.permissions.owner?e("v-btn",{key:"edit-perms",attrs:{id:"job-permissions-open",text:""},on:{click:function(a){return t.$emit("edit-permissions")}}},[e("v-icon",{attrs:{left:""}},[t._v(" mdi-account ")]),t._v(" Permissions ")],1):t._e(),e("v-spacer"),e("v-btn",{key:"edit-cancel",attrs:{text:""},on:{click:function(a){t.editing=!1}}},[e("span",[t._v("Cancel")]),e("v-icon",{attrs:{right:""}},[t._v(" mdi-undo-variant ")])],1)]:[t.data.permissions.operate||t.$userCan("OPERATE_ALL_JOBS")?[t.data.batch&&t.data.batch.id&&t.data.status==0?e("v-btn",{key:"batch-link",attrs:{text:"",to:"/batches/"+t.data.batch.id}},[e("v-icon",{attrs:{left:""}},[t._v(" mdi-tray-full ")]),e("span",[t._v("Go to Batch")])],1):t.data.hosts.length>0?e("v-btn",{key:"operate",attrs:{text:""},on:{click:function(a){return t.$emit("operate",t.operation.text)}}},[e("v-icon",{attrs:{left:""}},[t._v(" "+t._s(t.operation.icon)+" ")]),e("span",[t._v(t._s(t.operation.text))])],1):e("v-btn",{key:"assign",attrs:{text:""},on:{click:function(a){return t.$emit("edit-hosts")}}},[e("v-icon",{attrs:{left:""}},[t._v(" mdi-desktop-classic ")]),e("span",[t._v("Add Hosts")])],1)]:t._e(),e("v-spacer"),t.data.permissions.edit||t.$userCan("EDIT_ALL_JOBS")?e("v-btn",{key:"edit-enter",attrs:{id:"job-editor-open",text:""},on:{click:function(a){t.editing=!0}}},[e("span",[t._v("Edit")]),e("v-icon",{attrs:{right:""}},[t._v(" mdi-pencil ")])],1):t._e()]],2),e("v-list",{staticClass:"info-list",attrs:{inactive:"","two-line":""}},[e("transition",{attrs:{name:"fade",mode:"out-in"}},[t.editing?[e("job-editor",{attrs:{data:t.data},on:{save:t.saveEdit}})]:e("transition-group",{attrs:{tag:"div",name:"list"}},t._l(t.details,function(a){var s=a.title,r=a.icon,n=a.value;return e("v-list-item",{key:s},[e("v-list-item-content",[e("v-list-item-subtitle",{staticClass:"overline mb-1"},[e("v-icon",{staticClass:"mr-1",attrs:{small:""}},[t._v(" "+t._s(r)+" ")]),t._v(" "+t._s(s)+" ")],1),e("v-list-item-title",{staticClass:"pre"},[t._v(t._s(n))])],1)],1)}),1)],2)],1)],1)])},U=[];const L={components:{JobEditor:I},props:{data:{type:Object,default:()=>{}}},data(){return{editing:!1,testmode:localStorage.getItem("testmode")=="true"||!1}},computed:{statusColor(){return this.editing||this.data.hosts.length==0?"secondary":this.data.batch&&this.data.batch.id&&this.data.status==0?"primary":this.data.status_type},indtProgress(){return(this.data.progress==0||this.data.progress>=100)&&this.data.status==="10"||parseInt(this.data.status)>10},operation(){return this.data.status==="0"?{text:"start",icon:"mdi-play"}:this.data.status==="4"?{text:"resume",icon:"mdi-play"}:this.data.status<10?{text:"restart",icon:"mdi-restart"}:{text:"stop",icon:"mdi-stop"}},details(){const t=this.data;return[{title:"Part of batch",icon:"mdi-tray-full",value:t.batch.name},{title:"Comment",icon:"mdi-format-quote-close",value:t.comment},{title:"Keyspace",icon:"mdi-key",value:t.keyspace,format:l},{title:"Date Added",icon:"mdi-calendar-import",value:t.time,format:e=>this.$moment.utc(e).local().calendar()},{title:"Workunit Sum Time",icon:"mdi-sigma",value:t.workunit_sum_time_str},{title:"Cracking Time",icon:"mdi-timer",value:this.crackingTime},{title:"Estimated Cracking Time",icon:"mdi-bell-ring-outline",value:t.estimated_cracking_time_str},{title:"Start",icon:"mdi-ray-start",value:this.startTime},{title:"End",icon:"mdi-ray-end",value:this.endTime},{title:"Priority",icon:"mdi-priority-high",value:t.priority_str},{title:"Efficiency",hide:()=>!this.testmode,icon:"mdi-chart-timeline-variant",value:t.efficiency,format:e=>`${e} %`},{title:"Cracked Hashes",icon:"mdi-textbox-password",value:t.cracked_hashes_str},{title:"Time per workunit",hide:()=>t.fixed_workunit_size>0,icon:"mdi-timeline-clock",value:t.seconds_per_job,format:e=>`${e} seconds`},{title:"Fixed workunit size",hide:()=>t.fixed_workunit_size==0,icon:"mdi-grid",value:t.fixed_workunit_size,format:e=>`~ ${e} passwords`}].filter(e=>!e.hide||!e.hide()).filter(e=>e.value!=null&&e.value!=null&e.value!=="").map(e=>(e.format&&(e.value=e.format(e.value)),e))},crackingTime(){const t=this.data;return t.total_time?this.$moment.duration(t.total_time,"seconds").format():"Not started yet"},startTime(){const t=this.data;return t.time_start?this.$moment.utc(t.time_start).local().format("DD.MM.YYYY HH:mm"):"Not started yet"},endTime(){const t=this.data;return t.time_end?this.$moment.utc(t.time_end).local().format("DD.MM.YYYY HH:mm"):"Not planned"}},methods:{jobIcon:d,attackIcon:m,fmt:l,saveEdit(){this.editing=!1,this.$emit("reload")}}},_={};var z=o(L,F,U,!1,B,"458ce917",null,null);function B(t){for(let i in _)this[i]=_[i]}var K=function(){return z.exports}(),q=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",[e("v-card-title",[e("v-icon",{attrs:{left:""}},[t._v(" mdi-package-variant-closed ")]),e("b",{staticClass:"title"},[t._v("Workunits")]),e("v-spacer"),e("v-chip",{staticClass:"mr-2"},[e("v-avatar",{attrs:{left:""}},[e("v-icon",{attrs:{small:""}},[t._v(" mdi-chart-donut ")])],1),t._v(" "+t._s(t.title.benchmarks)+" benchmark ")],1),e("v-chip",{staticClass:"mr-2"},[e("v-avatar",{attrs:{left:""}},[e("v-icon",{attrs:{small:""}},[t._v(" mdi-hammer ")])],1),t._v(" "+t._s(t.title.valid)+" work ")],1),e("v-chip",[e("v-avatar",{attrs:{left:""}},[e("v-icon",{attrs:{small:""}},[t._v(" mdi-key ")])],1),t._v(" "+t._s(t.fmt(t.title.avgKeyspace))+" average keyspace ")],1)],1),e("div",{staticClass:"d-flex"},t._l(t.graphical,function(a){return e("div",{key:a.id,class:["workunit-child",a.state],style:{"flex-grow":a.keyspace}},[e("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(s){var r=s.on;return[e("div",t._g({},r),[t._v(" \xA0 ")])]}}],null,!0)},[e("span",[t._v(t._s(a.text))])])],1)}),0),e("v-data-table",{attrs:{"footer-props":t.footer,headers:t.headers,items:t.data.workunits,"show-expand":""},scopedSlots:t._u([{key:"item.host_id",fn:function(a){var s=a.item;return[e("div",{staticClass:"hostname"},[t.showChartPatterns?e("div",{staticClass:"pattern"},[e("canvas",{ref:"pattern-"+s.id,attrs:{"data-host-id":s.host_id,width:"15",height:"15"}})]):t._e(),e("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(r){var n=r.on;return[e("router-link",{staticClass:"middle",attrs:{to:{name:"hostDetail",params:{id:s.host.id}}}},[e("span",t._g({},n),[t._v(t._s(s.host.domain_name))])])]}}],null,!0)},[e("span",[t._v("User: "+t._s(s.host.user.name))])])],1)]}},{key:"item.progress",fn:function(a){var s=a.item;return[e("div",{staticClass:"d-flex align-center justify-end"},[e("span",{staticClass:"mr-2"},[t._v(t._s(s.progress)+"\xA0%")]),e("v-progress-circular",{staticClass:"jobProgress",attrs:{size:"18",width:3,rotate:270,color:"primary",value:s.progress}})],1)]}},{key:"item.hashrate",fn:function(a){var s=a.item;return[s.hashrate>=1e6?e("span",[t._v(" "+t._s(t.fmt(s.hashrate/1e3,{maximumFractionDigits:0}))+"\xA0kH/s ")]):s.hashrate>0?e("span",[t._v(" "+t._s(t.fmt(s.hashrate))+"\xA0H/s ")]):e("span",[t._v("\u2013")])]}},{key:"item.time",fn:function(a){var s=a.item;return[t._v(" "+t._s(t.$moment.utc(s.time).local().format("DD.MM.YYYY HH:mm"))+" ")]}},{key:"item.start_index_real",fn:function(a){var s=a.item;return[t._v(" "+t._s(t.fmt(s.start_index_real))+" ")]}},{key:"item.keyspace",fn:function(a){var s=a.item;return[t._v(" "+t._s(t.fmt(s.keyspace))+" ")]}},{key:"item.retry",fn:function(a){var s=a.item;return[e("v-chip",{attrs:{small:"",color:s.retry?"error":"success"}},[t._v(" "+t._s(s.retry?"Yes":"No")+" ")])]}},{key:"item.finished",fn:function(a){var s=a.item;return[e("v-chip",{attrs:{small:"",color:s.finished?"success":"error"}},[t._v(" "+t._s(s.finished?"Yes":"No")+" ")])]}},{key:"expanded-item",fn:function(a){var s=a.headers,r=a.item;return[e("td",{attrs:{colspan:s.length}},[e("fc-textarea",{attrs:{"max-height":"500",readonly:!0,value:r.result.stderr_out_text}})],1)]}}])})],1)},J=[];const G={components:{fcTextarea:S},props:{data:{type:Object,default:()=>{}},showChartPatterns:Boolean},mounted(){if(this.showChartPatterns){const t=Object.values(this.$refs),i=u(t.length,!0);t.forEach(e=>{console.log(e);const a=e.getContext("2d");a.rect(0,0,e.width,e.height),a.fillStyle=i[e.dataset.hostId-1],a.fill()})}},data(){return{title:{valid:0,benchmarks:0,avgKeyspace:0,efectivity:0},headers:[{text:"Host",value:"host_id"},{text:"Progress",align:"end",value:"progress"},{text:"Hashrate",align:"end",value:"hashrate"},{text:"Cracking time",align:"end",value:"cracking_time_str"},{text:"Generated",align:"end",value:"time"},{text:"Start index",align:"end",value:"start_index_real"},{text:"Keyspace",align:"end",value:"keyspace"},{text:"Retry",align:"center",value:"retry"},{text:"Finished",align:"center",value:"finished"},{text:"Est. remaining time",align:"center",value:"remaining_time_str"},{text:"Log",align:"center",value:"data-table-expand"}],footer:{itemsPerPageOptions:[15,30,60,{text:"All",value:-1}],itemsPerPageText:"Workunits per page"},graphical:[]}},watch:{data:{immediate:!0,deep:!0,handler(t){if(t.workunits.length>0){const i=t.workunits.filter(e=>e.hc_keyspace!==0);this.title.valid=i.length,this.title.benchmarks=t.workunits.length-i.length,i.length>0&&(this.title.avgKeyspace=i.map(e=>e.keyspace).reduce((e,a)=>e+a)/i.length),this.graphical=i.map(e=>{let a="";return!e.retry&&e.finished?a="success":!e.retry&&!e.finished?a="info":e.retry&&!e.finished?a="error":a="warning",{id:e.id,keyspace:e.keyspace,state:a,text:`ID ${e.id} (keyspace ${e.keyspace}, hc_keyspace ${e.hc_keyspace}) ${e.retry?"retried and":""} ${e.finished?"finished":"not finished"}`}})}}}},methods:{fmt:l}},p={};var W=o(G,q,J,!1,V,"39eef3d5",null,null);function V(t){for(let i in p)this[i]=p[i]}var Z=function(){return W.exports}(),Q=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"d-flex history-wrap"},[e("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(a){var s=a.on;return[e("v-btn",t._g({directives:[{name:"show",rawName:"v-show",value:t.entries.length>t.visible.length,expression:"entries.length > visible.length"}],staticClass:"mr-4 mt-3",attrs:{icon:""},on:{click:function(r){t.showAll=!0}}},s),[e("v-icon",[t._v("mdi-history")])],1)]}}])},[e("span",[t._v("All Entries")])]),e("div",{staticClass:"d-flex justify-space-between history-container"},t._l(t.visible,function(a){var s=a.time,r=a.status_text,n=a.status_type;return e("div",{key:s,staticClass:"history-entry"},[e("div",{staticClass:"overline"},[t._v(t._s(r))]),e("v-sheet",{staticClass:"mx-3"},[e("v-icon",{attrs:{color:n}},[t._v(" "+t._s(t.jobIcon(r))+" ")])],1),e("div",{staticClass:"subtitle-2 mt-2"},[t._v(" "+t._s(t.$moment.utc(s).local().format("DD.MM.YYYY"))+" ")]),e("div",[t._v(" "+t._s(t.$moment.utc(s).local().format("HH:mm"))+" ")])],1)}),0),e("v-dialog",{attrs:{"max-width":"500"},model:{value:t.showAll,callback:function(a){t.showAll=a},expression:"showAll"}},[e("v-card",[e("v-card-title",[e("span",[t._v("Full History")]),e("v-spacer"),e("v-btn",{attrs:{icon:""},on:{click:function(a){t.showAll=!1}}},[e("v-icon",[t._v("mdi-close")])],1)],1),e("v-card-text",[e("v-data-table",{attrs:{headers:[{text:"Time",value:"time",align:"start"},{text:"Status",value:"status",align:"end"}],items:t.entries,"footer-props":{itemsPerPageOptions:[10,25,50,{text:"All",value:-1}]}},scopedSlots:t._u([{key:"item.time",fn:function(a){var s=a.item;return[e("strong",[t._v(" "+t._s(t.$moment.utc(s.time).local().format("DD.MM.YYYY"))+" ")]),e("span",[t._v(" "+t._s(t.$moment.utc(s.time).local().format("HH:mm"))+" ")])]}},{key:"item.status",fn:function(a){var s=a.item;return[e("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(r){var n=r.on;return[e("span",t._g({class:["font-weight-medium",s.status_type+"--text"]},n),[t._v(" "+t._s(s.status_text)+" ")])]}}],null,!0)},[e("span",[t._v(t._s(s.status_tooltip))])])]}}])})],1)],1)],1)],1)},X=[];const tt={props:{entries:{type:Array,default:()=>[]}},data(){return{showAll:!1}},computed:{visible(){let t=0;for(let i=this.entries.length-1;i>=0;i--)if(this.entries[i].status==="0"){t=i;break}return this.entries.slice(t)}},methods:{jobIcon:d}},h={};var et=o(tt,Q,X,!1,at,null,null,null);function at(t){for(let i in h)this[i]=h[i]}var st=function(){return et.exports}(),it=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("v-data-table",{attrs:{headers:t.headers,items:t.hashes,"footer-props":t.footer},scopedSlots:t._u([{key:"item.hashText",fn:function(a){var s=a.item;return[e("span",{staticClass:"hash"},[t._v(" "+t._s(t.truncateHashIfNeeded(s.hashText))+" ")])]}}])})},rt=[];const nt={props:{hashes:{type:Array,default:()=>[]}},data(){return{headers:[{text:"Username",value:"username",align:"start"},{text:"Hash",value:"hashText",align:"start"},{text:"Password",value:"password",align:"end"}],footer:{itemsPerPageOptions:[10,25,50,100,{text:"All",value:-1}],itemsPerPageText:"Hashes per page"}}},methods:{truncateHashIfNeeded(t){return t.length>80?t.substr(0,70)+"...":t}}},f={};var ot=o(nt,it,rt,!1,lt,null,null,null);function lt(t){for(let i in f)this[i]=f[i]}var ct=function(){return ot.exports}(),dt=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("v-data-table",{attrs:{headers:t.headers,items:t.hosts,"hide-default-footer":"","no-data-text":"None assigned"},scopedSlots:t._u([{key:"item.name",fn:function(a){var s=a.item;return[e("div",{staticClass:"hostname"},[t.showChartPatterns?e("div",{staticClass:"pattern"},[e("canvas",{ref:"pattern-"+s.id,attrs:{width:"15",height:"15"}})]):t._e(),e("router-link",{staticClass:"middle",attrs:{to:{name:"hostDetail",params:{id:s.id}}}},[t._v(" "+t._s(s.domain_name+" ("+s.user.name+")")+" ")])],1)]}},{key:"item.last_active",fn:function(a){var s=a.item;return[s.last_active.seconds_delta>61?e("span",[t._v(t._s(t.parseTimeDelta(s.last_active.last_seen)))]):e("v-icon",{attrs:{color:"success"}},[t._v(" mdi-power ")])]}}])})},mt=[];const ut={props:{hosts:{type:Array,default:()=>[]},showChartPatterns:Boolean},data(){return{headers:[{text:"Name",align:"start",value:"name"},{text:"IP address",value:"ip_address",align:"end",sortable:!1},{text:"Online",value:"last_active",align:"end",sortable:!1}]}},mounted(){if(this.showChartPatterns){const t=Object.values(this.$refs),i=u(t.length,!0);t.forEach((e,a)=>{const s=e.getContext("2d");s.rect(0,0,e.width,e.height),s.fillStyle=i[a],s.fill()})}},methods:{parseTimeDelta(t){return t!=null?this.$moment.utc(t).fromNow():"Unknown"}}},y={};var vt=o(ut,dt,mt,!1,_t,"579ee6e2",null,null);function _t(t){for(let i in y)this[i]=y[i]}var pt=function(){return vt.exports}(),ht=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("v-dialog",{attrs:{"max-width":"800",value:t.value},on:{input:function(a){return t.$emit("input")}}},[e("v-card",[e("v-card-title",[e("span",[t._v("Permissions Manager")]),e("v-spacer"),e("v-btn",{attrs:{icon:""},on:{click:function(a){return t.$emit("input")}}},[e("v-icon",[t._v("mdi-close")])],1)],1),e("v-card-text",[e("div",[e("strong",[t._v("Assign permissions to specific users for this job.")]),e("ul",[e("li",[t._v("Only you can change these settings as the job owner.")]),e("li",[t._v("This does not affect users with global permission roles.")])])])]),e("v-card-text",[e("v-data-table",{attrs:{loading:t.loading,headers:t.headers,items:t.perms},scopedSlots:t._u([{key:"item.username",fn:function(a){var s=a.item;return[e("div",{staticClass:"py-2"},[e("div",{staticClass:"subtitle-2"},[t._v(" "+t._s(s.username)+" "),s.owner?e("span",[t._v(" (owner) ")]):t._e()]),e("div",{staticClass:"caption"},[t._v(" "+t._s(s.mail)+" ")])])]}},{key:"item.view",fn:function(a){var s=a.item;return[e("v-checkbox",{staticClass:"cc d-inline-block ma-0",attrs:{"on-icon":"mdi-eye","off-icon":"mdi-eye-off","hide-details":"",disabled:s.owner},on:{change:function(r){return t.update(s.id,"view",r)}},model:{value:s.view,callback:function(r){t.$set(s,"view",r)},expression:"item.view"}})]}},{key:"item.modify",fn:function(a){var s=a.item;return[e("v-checkbox",{staticClass:"cc d-inline-block ma-0",attrs:{"on-icon":"mdi-pencil","off-icon":"mdi-pencil-off","hide-details":"",disabled:s.owner},on:{change:function(r){return t.update(s.id,"modify",r)}},model:{value:s.modify,callback:function(r){t.$set(s,"modify",r)},expression:"item.modify"}})]}},{key:"item.operate",fn:function(a){var s=a.item;return[e("v-checkbox",{staticClass:"cc d-inline-block ma-0",attrs:{"on-icon":"mdi-flash","off-icon":"mdi-flash-off","hide-details":"",disabled:s.owner},on:{change:function(r){return t.update(s.id,"operate",r)}},model:{value:s.operate,callback:function(r){t.$set(s,"operate",r)},expression:"item.operate"}})]}}])}),e("v-menu",{attrs:{"close-on-content-click":!1,top:""},scopedSlots:t._u([{key:"activator",fn:function(a){var s=a.on;return[e("v-btn",t._g({on:{click:t.loadUsers}},s),[t._v(" Add User ")])]}}]),model:{value:t.addUserMenu,callback:function(a){t.addUserMenu=a},expression:"addUserMenu"}},[e("v-card",[e("v-card-text",[e("v-autocomplete",{attrs:{loading:t.fetchingUsers,items:t.users,autofocus:"","item-text":"username","item-value":"id",label:"Type username"},on:{input:t.addUser}})],1)],1)],1)],1),e("v-card-actions",[e("v-progress-linear",{attrs:{color:"secondary",indeterminate:t.saving,rounded:""}})],1)],1)],1)},ft=[];const yt={components:{},props:{value:Boolean,jobId:{type:Number,required:!0}},data(){return{perms:[],users:[],addUserMenu:!1,loading:!0,fetchingUsers:!1,saving:!1,headers:[{text:"User",align:"start",value:"username"},{text:"View",value:"view",align:"center",sortable:!1},{text:"Edit",value:"modify",align:"center",sortable:!1},{text:"Operate",value:"operate",align:"center",sortable:!1}]}},mounted(){this.load()},methods:{async load(){this.loading=!0,this.perms=await this.axios.get(`${this.$serverAddr}/job/${this.jobId}/permissions`).then(t=>t.data.items),this.loading=!1},async loadUsers(){this.users.length==0&&(this.fetchingUsers=!0,this.users=await this.axios.get(`${this.$serverAddr}/user/`).then(t=>t.data.items),this.fetchingUsers=!1)},async addUser(t){this.addUserMenu=!1,await this.update(t),this.load()},async update(t,i="view",e=!1){this.saving=!0;try{await this.axios.put(`${this.$serverAddr}/job/${this.jobId}/permissions`,{user_id:t,[i]:e})}catch(a){console.error(a)}finally{this.saving=!1}}}},g={};var gt=o(yt,ht,ft,!1,xt,null,null,null);function xt(t){for(let i in g)this[i]=g[i]}var kt=function(){return gt.exports}(),bt=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("fc-tile",{attrs:{title:"Dictionaries and rules"}},[e("v-card-title",[t._v(" Left ")]),e("v-data-table",{attrs:{headers:t.headers,items:t.data.left_dictionaries,"hide-default-footer":""},scopedSlots:t._u([{key:"item.dictionary.name",fn:function(a){var s=a.item.dictionary;return[e("router-link",{attrs:{to:{name:"dictionaryDetail",params:{id:s.id}}}},[t._v(" "+t._s(s.name)+" "),e("v-icon",{attrs:{small:"",color:"primary"}},[t._v(" mdi-open-in-new ")])],1)]}},{key:"item.dictionary.keyspace",fn:function(a){var s=a.item.dictionary;return[t._v(" "+t._s(t.fmt(s.keyspace))+" ")]}}])}),t.data.rule_left!==""?[e("v-list-item",{staticClass:"px-2 py-1"},[e("v-list-item-action",{staticClass:"pr-3 key"},[t._v(" Left rule: ")]),e("v-list-item-content",[e("v-list-item-title",{staticClass:"text-right"},[t._v(" "+t._s(t.data.rule_left)+" ")])],1)],1)]:t._e(),e("v-divider"),e("v-card-title",[t._v(" Right ")]),e("v-data-table",{attrs:{headers:t.rightHeaders,items:t.data.right_dictionaries,"hide-default-footer":""},scopedSlots:t._u([{key:"item.dictionary.name",fn:function(a){var s=a.item.dictionary;return[e("router-link",{attrs:{to:{name:"dictionaryDetail",params:{id:s.id}}}},[t._v(" "+t._s(s.name)+" "),e("v-icon",{attrs:{small:"",color:"primary"}},[t._v(" mdi-open-in-new ")])],1)]}},{key:"item.dictionary.keyspace",fn:function(a){var s=a.item.dictionary;return[t._v(" "+t._s(t.fmt(s.keyspace))+" ")]}},{key:"item.progress",fn:function(a){var s=a.item,r=s.current_index,n=s.dictionary.keyspace;return[e("v-progress-circular",{attrs:{size:"16",width:3,rotate:270,color:"primary",value:100/n*r}}),e("span",[t._v(t._s((100/n*r).toFixed())+" %")])]}}])}),t.data.rule_right!==""?[e("v-divider"),e("v-list-item",{staticClass:"px-2 py-1"},[e("v-list-item-action",{staticClass:"pr-3 key"},[t._v(" Right rule: ")]),e("v-list-item-content",[e("v-list-item-title",{staticClass:"text-right"},[t._v(" "+t._s(t.data.rule_right)+" ")])],1)],1)]:t._e()],2)},$t=[];const Ct={name:"CombinatorDetail",components:{"fc-tile":c},props:["data"],data(){return{headers:[{text:"Name",align:"left",value:"dictionary.name"},{text:"Keyspace",value:"dictionary.keyspace",align:"right"}]}},computed:{rightHeaders(){return[...this.headers,{text:"Progress",value:"progress",align:"right"}]}},methods:{fmt:l}},x={};var wt=o(Ct,bt,$t,!1,jt,"5b4e77de",null,null);function jt(t){for(let i in x)this[i]=x[i]}var Dt=function(){return wt.exports}(),Ht=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("fc-tile",{attrs:{title:"Hybrid attack details"}},[e("v-card-title",[t._v(" Mask ")]),e("v-data-table",{attrs:{headers:t.maskHeaders,items:t.data.masks,"hide-default-footer":""}}),e("v-divider"),e("v-card-title",[t._v(" Dictionaries ")]),e("v-data-table",{attrs:{headers:t.headers,items:t.dicts,"hide-default-footer":""},scopedSlots:t._u([{key:"item.dictionary.name",fn:function(a){var s=a.item.dictionary;return[e("router-link",{attrs:{to:{name:"dictionaryDetail",params:{id:s.id}}}},[t._v(" "+t._s(s.name)+" "),e("v-icon",{attrs:{small:"",color:"primary"}},[t._v(" mdi-open-in-new ")])],1)]}},{key:"item.dictionary.keyspace",fn:function(a){var s=a.item.dictionary;return[t._v(" "+t._s(t.fmt(s.keyspace))+" ")]}},{key:"item.progress",fn:function(a){var s=a.item,r=s.current_index,n=s.dictionary.keyspace;return[e("v-progress-circular",{attrs:{size:"16",width:3,rotate:270,color:"primary",value:100/n*r}}),e("span",[t._v(t._s((100/n*r).toFixed())+" %")])]}}])}),t.hasRule?[e("v-divider"),e("v-list-item",{staticClass:"px-2 py-1"},[e("v-list-item-action",{staticClass:"pr-3 key"},[t._v(" Rule: ")]),e("v-list-item-content",[e("v-list-item-title",{staticClass:"text-right"},[t._v(" "+t._s(t.rule)+" ")])],1)],1)]:t._e()],2)},St=[];const Et={name:"CombinatorDetail",components:{"fc-tile":c},props:["data"],data(){return{maskHeaders:[{text:"Mask",align:"left",value:"mask"}]}},computed:{dicts(){return this.data.attack_mode==="7"?this.data.right_dictionaries:this.data.left_dictionaries},hasRule(){return this.data.rule_left!==""||this.data.rule_right!==""},rule(){return this.data.attack_mode==="7"?this.data.rule_right:this.data.rule_left},headers(){const t=[{text:"Name",align:"left",value:"dictionary.name"},{text:"Keyspace",value:"dictionary.keyspace",align:"right"}];return this.data.attack_mode==="6"?t:[...t,{text:"Progress",value:"progress",align:"right"}]}},methods:{fmt:l}},k={};var Mt=o(Et,Ht,St,!1,Pt,"7ad525f8",null,null);function Pt(t){for(let i in k)this[i]=k[i]}var At=function(){return Mt.exports}(),Yt=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("fc-tile",{attrs:{title:"Attack details"}},[e("v-data-table",{attrs:{headers:t.maskHeaders,items:t.data.masks,"hide-default-footer":""},scopedSlots:t._u([{key:"item.progress",fn:function(a){var s=a.item;return[e("v-progress-circular",{attrs:{size:"16",width:3,rotate:270,color:"primary",value:s.progress}}),e("span",[t._v(t._s(t.progressToPercentage(s.progress)))])]}}])}),e("v-list",{staticClass:"width100",attrs:{"single-line":""}},[t.data.markov.id!==null?[e("v-divider"),e("v-list-item",{staticClass:"px-2 py-1"},[e("v-list-item-action",{staticClass:"pr-3 key"},[t._v(" Markov: ")]),e("v-list-item-content",[e("v-list-item-title",{staticClass:"text-right"},[e("a",{attrs:{target:"_blank",href:t.$serverAddr+"/markovChains/"+t.data.markov.id}},[t._v(t._s(t.data.markov.name))])])],1)],1)]:t._e()],2)],1)},Nt=[];const Tt={name:"MaskDetail",components:{"fc-tile":c},props:{data:Object,customCharsets:{type:[Array,null],default:null}},data:function(){return{maskHeaders:[{text:"Mask",align:"left",value:"mask"},{text:"Progress",value:"progress",align:"right"}],represenArray:{l:{chars:"abcdefghijklmnopqrstuvwxyz",represent:"a-z"},u:{chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",represent:"A-Z"},d:{chars:"0123456789",represent:"0-9"},h:{chars:"0123456789abcdef",represent:"0-f"},H:{chars:"0123456789ABCDEF",represent:"0-F"},s:{chars:'\xABspace\xBB!"#$%&()*+,-./:;<=>?@[]^_`{|}~',represent:"special"},a:{chars:"?l?u?d?s",represent:"a-z,A-Z,0-9,special"},b:{chars:"0x00 - 0xff",represent:"ASCII"}}}},methods:{progressToPercentage:function(t){return t.toFixed()+"%"},parseHTML(t){console.log(t);for(var i=!1,e="",a=0;a<t.length;a++){if(i){if(t[a]==="?"){e+="?",i=!1;continue}var s=this.represenArray[t[a]];s===void 0&&(s={represent:t[a]}),e+='<span class="symbol primary--text">'+s.represent+"</span>",i=!1;continue}t[a]==="?"?i=!0:(e+=t[a],i=!1)}return e}}},b={};var Ot=o(Tt,Yt,Nt,!1,Rt,"19af215e",null,null);function Rt(t){for(let i in b)this[i]=b[i]}var It=function(){return Ot.exports}(),Ft=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("fc-tile",{attrs:{title:"Dictionaries and rules"}},[e("v-data-table",{attrs:{headers:t.dictionary_table_headers,items:t.data.left_dictionaries,"hide-default-footer":""},scopedSlots:t._u([{key:"item.dictionary.name",fn:function(a){var s=a.item.dictionary;return[e("router-link",{attrs:{to:{name:"dictionaryDetail",params:{id:s.id}}}},[t._v(" "+t._s(s.name)+" "),e("v-icon",{attrs:{small:"",color:"primary"}},[t._v(" mdi-open-in-new ")])],1)]}},{key:"item.dictionary.keyspace",fn:function(a){var s=a.item.dictionary;return[t._v(" "+t._s(t.fmt(s.keyspace))+" ")]}},{key:"item.progress",fn:function(a){var s=a.item,r=s.current_index,n=s.dictionary.keyspace;return[e("v-progress-circular",{attrs:{size:"16",width:3,rotate:270,color:"primary",value:100/n*r}}),e("span",[t._v(t._s((100/n*r).toFixed())+" %")])]}}])}),t.data.rules.length>0?e("v-data-table",{attrs:{headers:t.rule_table_headers,items:t.data.rules,"hide-default-footer":""},scopedSlots:t._u([{key:"item.rule.name",fn:function(a){var s=a.item.rule;return[e("router-link",{attrs:{to:{name:"ruleDetail",params:{id:s.id}}}},[t._v(" "+t._s(s.name)+" "),e("v-icon",{attrs:{small:"",color:"primary"}},[t._v(" mdi-open-in-new ")])],1)]}},{key:"item.rule.keyspace",fn:function(a){var s=a.item.rule;return[t._v(" "+t._s(t.fmt(s.count))+" ")]}}],null,!1,1511459547)}):t._e()],1)},Ut=[];const Lt={name:"DictionaryDetail",components:{"fc-tile":c},props:{data:{type:Object,default:()=>{}}},data(){return{dictionary_table_headers:[{text:"Dictionary name",align:"start",value:"dictionary.name"},{text:"Keyspace",value:"dictionary.keyspace",align:"end"},{text:"Progress",value:"progress",align:"end"}],rule_table_headers:[{text:"Rule name",align:"start",value:"rule.name"},{text:"Count",value:"rule.count",align:"end"}]}},methods:{fmt:l}},$={};var zt=o(Lt,Ft,Ut,!1,Bt,"4f4c8897",null,null);function Bt(t){for(let i in $)this[i]=$[i]}var Kt=function(){return zt.exports}(),qt=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("fc-tile",{attrs:{title:"PRINCE attack details"}},[e("v-data-table",{attrs:{headers:t.dictionary_table_headers,items:t.data.left_dictionaries,"hide-default-footer":""},scopedSlots:t._u([{key:"item.dictionary.name",fn:function(a){var s=a.item.dictionary;return[e("router-link",{attrs:{to:{name:"dictionaryDetail",params:{id:s.id}},target:"_blank"}},[t._v(" "+t._s(s.name)+" "),e("v-icon",{attrs:{small:"",color:"primary"}},[t._v(" mdi-open-in-new ")])],1)]}},{key:"item.dictionary.keyspace",fn:function(a){var s=a.item.dictionary;return[t._v(" "+t._s(t.fmt(s.keyspace))+" ")]}},{key:"item.dictionary.time",fn:function(a){var s=a.item.dictionary;return[t._v(" "+t._s(t.$moment.utc(s.time).local().format("DD.MM.YYYY HH:mm"))+" ")]}}])}),t.data.rules.length>0?e("v-data-table",{attrs:{headers:t.rule_table_headers,items:t.data.rules,"hide-default-footer":""},scopedSlots:t._u([{key:"item.rule.name",fn:function(a){var s=a.item.rule;return[e("router-link",{attrs:{to:{name:"ruleDetail",params:{id:s.id}}}},[t._v(" "+t._s(s.name)+" "),e("v-icon",{attrs:{small:"",color:"primary"}},[t._v(" mdi-open-in-new ")])],1)]}},{key:"item.rule.keyspace",fn:function(a){var s=a.item.rule;return[t._v(" "+t._s(t.fmt(s.count))+" ")]}}],null,!1,1511459547)}):t._e(),e("v-divider"),e("v-list-item",{staticClass:"px-2 py-1"},[e("v-list-item-action",{staticClass:"pr-3 key"},[t._v(" Check for password duplicates: ")]),e("v-list-item-content",[e("v-list-item-title",{staticClass:"text-right"},[t._v(" "+t._s(t.data.check_duplicates?"Yes":" No")+" ")])],1)],1),e("v-divider"),e("v-list-item",{staticClass:"px-2 py-1"},[e("v-list-item-action",{staticClass:"pr-3 key"},[t._v(" Case permutation: ")]),e("v-list-item-content",[e("v-list-item-title",{staticClass:"text-right"},[t._v(" "+t._s(t.data.case_permute?"Enabled":" Disabled")+" ")])],1)],1),e("v-divider"),e("v-list-item",{staticClass:"px-2 py-1"},[e("v-list-item-action",{staticClass:"pr-3 key"},[t._v(" Minimal length of passwords: ")]),e("v-list-item-content",[e("v-list-item-title",{staticClass:"text-right"},[t._v(" "+t._s(t.data.min_password_len)+" ")])],1)],1),e("v-divider"),e("v-list-item",{staticClass:"px-2 py-1"},[e("v-list-item-action",{staticClass:"pr-3 key"},[t._v(" Maximal length of passwords: ")]),e("v-list-item-content",[e("v-list-item-title",{staticClass:"text-right"},[t._v(" "+t._s(t.data.max_password_len)+" ")])],1)],1),e("v-divider"),e("v-list-item",{staticClass:"px-2 py-1"},[e("v-list-item-action",{staticClass:"pr-3 key"},[t._v(" Minimal number of elements per chain: ")]),e("v-list-item-content",[e("v-list-item-title",{staticClass:"text-right"},[t._v(" "+t._s(t.data.min_elem_in_chain)+" ")])],1)],1),e("v-divider"),e("v-list-item",{staticClass:"px-2 py-1"},[e("v-list-item-action",{staticClass:"pr-3 key"},[t._v(" Maximal number of elements per chain: ")]),e("v-list-item-content",[e("v-list-item-title",{staticClass:"text-right"},[t._v(" "+t._s(t.data.max_elem_in_chain)+" ")])],1)],1)],1)},Jt=[];const Gt={name:"PrinceDetail",components:{"fc-tile":c},props:{data:{type:Object,default:()=>{}}},data(){return{dictionary_table_headers:[{text:"Dictionary name",align:"start",value:"dictionary.name"},{text:"Keyspace",value:"dictionary.keyspace",align:"end"},{text:"Progress",value:"progress",align:"end"}],rule_table_headers:[{text:"Rule name",align:"start",value:"rule.name"},{text:"Count",value:"rule.count",align:"end"}]}},methods:{fmt:l}},C={};var Wt=o(Gt,qt,Jt,!1,Vt,"5ee7e6ff",null,null);function Vt(t){for(let i in C)this[i]=C[i]}var Zt=function(){return Wt.exports}(),Qt=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("fc-tile",{attrs:{title:"PCFG info"}},[e("v-list",{staticClass:"width100",attrs:{"single-line":""}},[e("v-list-item",{staticClass:"px-2 py-1"},[e("v-list-item-action",{staticClass:"pr-3 key"},[t._v(" Grammar: ")]),e("v-list-item-content",{staticClass:"text-right"},[e("v-list-item-title",[e("router-link",{attrs:{to:{name:"pcfg",params:{id:t.data.grammar_id}}}},[t._v(" "+t._s(t.data.grammar_name||"ID "+t.data.grammar_id)+" "),e("v-icon",{attrs:{small:"",color:"primary"}},[t._v(" mdi-open-in-new ")])],1)],1),e("span",[t._v(" Keyspace: "+t._s(t.fmt(t.data.grammar_keyspace)||"not specified")+" ")])],1)],1),t.data.rules.length>0?e("v-data-table",{attrs:{headers:t.rule_table_headers,items:t.data.rules,"hide-default-footer":""},scopedSlots:t._u([{key:"item.rule.name",fn:function(a){var s=a.item.rule;return[e("router-link",{attrs:{to:{name:"ruleDetail",params:{id:s.id}}}},[t._v(" "+t._s(s.name)+" "),e("v-icon",{attrs:{small:"",color:"primary"}},[t._v(" mdi-open-in-new ")])],1)]}},{key:"item.rule.keyspace",fn:function(a){var s=a.item.rule;return[t._v(" "+t._s(t.fmt(s.count))+" ")]}}],null,!1,1511459547)}):t._e()],1)],1)},Xt=[];const te={name:"PcfgDetail",components:{"fc-tile":c},props:["data"],data(){return{rule_table_headers:[{text:"Rule name",align:"start",value:"rule.name"},{text:"Count",value:"rule.count",align:"end"}]}},methods:{fmt:l}},w={};var ee=o(te,Qt,Xt,!1,ae,"d0165e92",null,null);function ae(t){for(let i in w)this[i]=w[i]}var se=function(){return ee.exports}(),ie=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"jd-container"},[t.data?t._e():e("v-progress-linear",{attrs:{indeterminate:"",color:"secondary"}}),e("v-sheet",{staticClass:"jd-split"},[e("transition",{attrs:{name:"info"}},[t.data?e("job-info",{staticClass:"jd-info",attrs:{data:t.data},on:{operate:t.operateJob,"edit-hosts":function(a){t.hostEditorOpen=!0},"edit-permissions":function(a){t.permsEditorOpen=!0},reload:t.loadData}}):t._e()],1),e("v-divider",{attrs:{vertical:""}}),e("transition",{attrs:{name:"main"}},[t.data?e("div",{staticClass:"jd-main"},[e("v-expansion-panels",{attrs:{accordion:"",multiple:"",flat:"",hover:""},model:{value:t.openPanels,callback:function(a){t.openPanels=a},expression:"openPanels"}},[e("v-expansion-panel",[e("v-expansion-panel-header",[e("span",{staticClass:"expansion-header"},[e("v-icon",{attrs:{left:""}},[t._v(" mdi-file-document-box-search-outline ")]),e("b",{staticClass:"title"},[t._v("Details")])],1)]),e("v-expansion-panel-content",[t.statusHistory&&t.statusHistory.length>1?e("v-row",[e("v-col",[e("v-card-title",[e("span",[t._v("Status History")]),e("v-spacer"),t.data.permissions.operate||t.$userCan("OPERATE_ALL_JOBS")?e("v-btn",{attrs:{color:t.purging?"":"error",ripple:!1},on:{click:t.purgeHandler}},[e("span",[t._v(t._s(t.purging?"Click to confirm":"Purge"))]),e("v-icon",{attrs:{right:""}},[t._v(" mdi-undo-variant ")])],1):t._e()],1),e("status-timeline",{staticClass:"history px-4",attrs:{entries:t.statusHistory}})],1)],1):t._e(),e("v-row",[e("v-col",[e(t.attackDetailComponent,{tag:"component",staticClass:"attack-info",attrs:{data:t.data}})],1),e("v-col",[e("v-card",{attrs:{flat:""}},[e("v-card-title",[e("span",[t._v("Hashes")]),e("v-spacer"),t.anyHashCracked()?e("div",[e("v-btn",{attrs:{color:"primary"},on:{click:t.exportCrackedHashes}},[e("span",[t._v("Cracked hashes")]),e("v-icon",{attrs:{right:""}},[t._v(" mdi-file-download-outline ")])],1)],1):t._e(),t.anyHashNonCracked()?e("div",[e("v-btn",{attrs:{color:"secondary"},on:{click:t.exportNonCrackedHashes}},[e("span",[t._v("Non-cracked hashes")]),e("v-icon",{attrs:{right:""}},[t._v(" mdi-file-download-outline ")])],1)],1):t._e()],1),e("v-card-text",[e("hash-table",{staticClass:"grow",attrs:{hashes:t.data.hashes}})],1)],1)],1)],1)],1)],1),e("v-expansion-panel",[e("v-divider"),e("v-expansion-panel-header",[e("span",{staticClass:"expansion-header"},[e("v-icon",{attrs:{left:""}},[t._v(" mdi-desktop-classic ")]),e("b",{staticClass:"title"},[t._v("Hosts")])],1)]),e("v-expansion-panel-content",[e("v-row",{staticClass:"align-center"},[e("v-col",{attrs:{cols:"8"}},[e("host-table",{attrs:{hosts:t.data.hosts,"show-chart-patterns":""}}),e("div",{staticClass:"d-flex mt-2"},[e("v-spacer"),t.data.permissions.edit||t.$userCan("EDIT_ALL_JOBS")?e("v-btn",{attrs:{color:"info"},on:{click:function(a){t.hostEditorOpen=!0}}},[e("span",[t._v("Assign Hosts")]),e("v-icon",{attrs:{right:""}},[t._v(" mdi-playlist-edit ")])],1):t._e()],1)],1),e("v-col",{attrs:{cols:"4"}},[e("job-contribution-chart",{attrs:{id:t.data.id}})],1)],1)],1)],1),e("v-expansion-panel",{on:{change:t.statsToggled}},[e("v-divider"),e("v-expansion-panel-header",[e("span",{staticClass:"expansion-header"},[e("v-icon",{attrs:{left:""}},[t._v(" mdi-poll ")]),e("b",{staticClass:"title"},[t._v("Statistics")])],1)]),e("v-expansion-panel-content",[e("v-row",{ref:"chartrow"},[e("v-col",{attrs:{cols:"6"}},[e("v-card-title",[t._v("Progress over time")]),e("job-progress-chart",{attrs:{id:t.data.id}})],1),e("v-col",{attrs:{cols:"6"}},[e("v-card-title",[t._v("Hashes in workunits")]),e("job-workunit-chart",{attrs:{id:t.data.id}})],1)],1)],1)],1)],1)],1):t._e()])],1),e("v-divider"),t.data?e("workunits",{staticClass:"wu-container",attrs:{"show-chart-patterns":"",data:t.data}}):t._e(),t.data?e("host-editor",{attrs:{"job-ids":[t.data.id]},on:{reload:t.loadData},model:{value:t.hostEditorOpen,callback:function(a){t.hostEditorOpen=a},expression:"hostEditorOpen"}}):t._e(),t.data?e("perms-editor",{attrs:{"job-id":t.data.id},model:{value:t.permsEditorOpen,callback:function(a){t.permsEditorOpen=a},expression:"permsEditorOpen"}}):t._e()],1)},re=[];let j;const ne={components:{jobInfo:K,workunits:Z,statusTimeline:st,hashTable:ct,hostTable:pt,hostEditor:E,permsEditor:kt,jobProgressChart:M,jobWorkunitChart:P,jobContributionChart:A,combinatorDetail:Dt,hybridDetail:At,maskDetail:It,dictionaryDetail:Kt,princeDetail:Zt,pcfgDetail:se},data(){return{data:null,statusHistory:null,progressGraph:null,hostGraph:null,hostPercentageGraph:null,hostEditorOpen:!1,permsEditorOpen:!1,openPanels:[0,1,2],purging:!1,chartHeight:"0px"}},computed:{attackDetailComponent(){switch(this.data.attack){case"mask":return"maskDetail";case"dictionary":return"dictionaryDetail";case"pcfg":return"pcfgDetail";case"prince":return"princeDetail";case"combinator":return"combinatorDetail";default:return"hybridDetail"}},shouldConfirmPurge(){return localStorage.hasOwnProperty("confirmpurge")?localStorage.getItem("confirmpurge")=="true":!0}},mounted(){this.loadAll(),j=setInterval(this.loadAll,5e3)},beforeDestroy(){clearInterval(j)},methods:{jobIcon:d,attackIcon:m,async loadHistory(){this.statusHistory=await this.axios.get(this.$serverAddr+"/status/"+this.$route.params.id).then(t=>t.data.items)},async loadData(){this.data=await this.axios.get(this.$serverAddr+"/job/"+this.$route.params.id).then(t=>t.data),document.title=`${this.data.name} \u2013 ${this.$store.state.project}`},loadAll(){this.loadData(),this.loadHistory()},operateJob(t){this.axios.get(this.$serverAddr+"/job/"+this.data.id+"/action",{params:{operation:t}}).then(this.loadAll)},purgeHandler(){this.shouldConfirmPurge&&!this.purging?(this.purging=!0,setTimeout(()=>{this.purging=!1},3e3)):(this.purging=!1,this.operateJob("kill"))},statsToggled(){const t=this.$refs.chartrow.querySelectorAll(".chart-wrapper");Array.from(t).forEach(i=>{const e=getComputedStyle(i).getPropertyValue("height");e!=="0px"&&e!=="auto"?this.chartHeight=e:i.style.height=this.chartHeight})},anyHashCracked(){return this.data.hashes.some(t=>t.password!=null)},exportCrackedHashes(){this.axios.get(this.$serverAddr+"/job/"+this.data.id+"/exportCrackedHashes").then(t=>{const i=window.URL.createObjectURL(new Blob([t.data])),e=document.createElement("a");e.href=i,e.setAttribute("download",this.data.name+"_cracked_hashes.txt"),document.body.appendChild(e),e.click(),document.body.removeChild(e)}).catch(t=>{console.error("Error downloading file:",t)})},anyHashNonCracked(){return this.data.hashes.some(t=>t.password==null)},exportNonCrackedHashes(){this.axios.get(this.$serverAddr+"/job/"+this.data.id+"/exportNonCrackedHashes").then(t=>{const i=window.URL.createObjectURL(new Blob([t.data])),e=document.createElement("a");e.href=i,e.setAttribute("download",this.data.name+"_noncracked_hashes.txt"),document.body.appendChild(e),e.click(),document.body.removeChild(e)}).catch(t=>{console.error("Error downloading file:",t)})}}},D={};var oe=o(ne,ie,re,!1,le,"0dfff257",null,null);function le(t){for(let i in D)this[i]=D[i]}var je=function(){return oe.exports}();export{je as default};

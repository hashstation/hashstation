import"./index.c2579a33.js";import{n as l}from"./index.f593e833.js";import"./index.4014802a.js";import"./vendor.6aa46313.js";var d=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"cont"},[t("div",{staticClass:"d-flex justify-space-between align-center px-4 pt-2"},[t("v-switch",{staticClass:"mr-4",attrs:{label:"View hidden hosts","prepend-icon":e.viewHidden?"mdi-eye-off":"mdi-eye"},model:{value:e.viewHidden,callback:function(s){e.viewHidden=s},expression:"viewHidden"}}),t("v-text-field",{staticClass:"px-2 pt-3",attrs:{clearable:"","prepend-inner-icon":"mdi-table-search",label:"Search","single-line":""},on:{input:e.updateList},model:{value:e.search,callback:function(s){e.search=s},expression:"search"}})],1),t("v-divider"),t("v-data-table",{ref:"table",attrs:{headers:e.headers,items:e.hosts,search:e.search,options:e.pagination,"server-items-length":e.totalItems,loading:e.loading,"footer-props":{itemsPerPageOptions:[25,50,100],itemsPerPageText:"Hosts per page"},"fixed-header":""},on:{"update:options":function(s){e.pagination=s}},scopedSlots:e._u([{key:"item.domain_name",fn:function(s){var a=s.item;return[t("router-link",{staticClass:"middle font-weight-bold",attrs:{to:{name:"hostDetail",params:{id:a.id}}}},[e._v(" "+e._s(a.domain_name+" ("+a.user.name+")")+" ")])]}},{key:"item.jobs",fn:function(s){var a=s.item;return[e._v(" "+e._s(a.jobs.map(function(i){return[10,12].includes(i.status)?1:0}).reduce(function(i,o){return i+o},0))+" ")]}},{key:"item.p_model",fn:function(s){var a=s.item;return[t("span",{staticClass:"oneline"},[e._v(e._s(a.p_model.replace(/(?:\(R\)|\(TM\)|Intel|AMD)/g,"")))])]}},{key:"item.last_active",fn:function(s){var a=s.item;return[a.last_active.seconds_delta>61?t("span",[e._v(e._s(e.parseTimeDelta(a.last_active.last_seen)))]):t("v-icon",{attrs:{color:"success"}},[e._v(" mdi-power ")])]}},{key:"item.actions",fn:function(s){var a=s.item;return[t("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(i){var o=i.on;return[t("v-btn",e._g({staticClass:"mx-0",attrs:{icon:"",to:{name:"hostDetail",params:{id:a.id}}}},o),[t("v-icon",[e._v(" "+e._s("mdi-settings")+" ")])],1)]}}],null,!0)},[t("span",[e._v("Manage")])]),t("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(i){var o=i.on;return[t("v-btn",e._g({staticClass:"mx-0",attrs:{icon:""},on:{click:function(p){return e.hideHost(a.id)}}},o),[t("v-icon",[e._v(" "+e._s(a.deleted?"mdi-eye":"mdi-eye-off")+" ")])],1)]}}],null,!0)},[t("span",[e._v(e._s(a.deleted?"Show":"Hide"))])])]}}])})],1)},c=[];const u={name:"HostsView",data:function(){return{interval:null,search:"",viewHidden:!1,totalItems:0,pagination:{},loading:!0,headers:[{text:"Name",align:"start",value:"domain_name"},{text:"IP address",value:"ip_address",align:"end",sortable:!1},{text:"Operating system",value:"os_name",align:"end",sortable:!1},{text:"Processor",value:"p_model",align:"end",width:"200",sortable:!1},{text:"Active jobs",value:"jobs",align:"center",sortable:!1},{text:"Online",value:"last_active",align:"center",sortable:!1},{text:"Actions",value:"actions",align:"center",sortable:!1}],hosts_statuses:[],hosts:[]}},watch:{pagination:{handler:"updateList",deep:!0},"$route.name":"updateList",viewHidden:"updateList"},mounted(){this.interval=setInterval(function(){this.loadHosts()}.bind(this),5e3)},beforeDestroy:function(){clearInterval(this.interval)},methods:{parseTimeDelta:function(e){return e!=null?this.$moment.utc(e).fromNow():"Unknown"},loadHosts(){this.axios.get(this.$serverAddr+"/hosts",{params:{page:this.pagination.page,per_page:this.pagination.itemsPerPage,order_by:this.pagination.sortBy[0],descending:this.pagination.sortDesc[0],name:this.search,showDeleted:this.viewHidden}}).then(e=>{this.hosts=e.data.items,this.totalItems=e.data.total,this.loading=!1})},updateList(){this.loading=!0,this.loadHosts()},hideHost:function(e){this.loading=!0,this.axios.delete(this.$serverAddr+"/hosts/"+e).then(n=>{this.loadHosts()})}}},r={};var m=l(u,d,c,!1,v,"75c1c9aa",null,null);function v(e){for(let n in r)this[n]=r[n]}var x=function(){return m.exports}();export{x as default};
